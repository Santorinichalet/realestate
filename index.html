

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù…ØªÙ„ÙƒØ§Øª â€” v34 (fix)</title>
<style>
  :root{ --bg:#f6f7fb; --card:#fff; --border:#e5e7eb; --muted:#6b7280; --fg:#0f172a; --accent:#2563eb; --danger:#ef4444; --success:#16a34a }
  *{box-sizing:border-box}
  body{margin:0;background:linear-gradient(#f8fafc,#eef2f7);font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Naskh Arabic","Tahoma",sans-serif;color:var(--fg)}
  header{position:sticky;top:0;background:rgba(255,255,255,.9);backdrop-filter:blur(8px);border-bottom:1px solid var(--border);z-index:10}
  .container{max-width:1200px;margin:0 auto;padding:14px}
  .brand{display:flex;gap:8px;align-items:center;font-weight:700}
  .brand img{height:42px;width:auto;border-radius:6px;object-fit:contain}
  .toolbar{display:flex;gap:8px;flex-wrap:wrap}
  .btn{border:1px solid var(--border);background:#fff;border-radius:12px;padding:8px 12px;cursor:pointer}
  .btn.primary{background:#2563eb;color:#fff;border-color:#2563eb; background:#1f6fff;color:#fff;border-color:#1f6fff}
  .btn.icon{padding:8px 12px;border-radius:14px}
  .btn.danger{background:#ef4444;color:#fff;border-color:#ef4444}
  main{padding:14px}
  .grid{display:grid;gap:12px}
  @media(min-width:960px){.grid.cols-3{grid-template-columns:repeat(3,1fr)}}
  @media(min-width:640px){.grid.cols-2{grid-template-columns:repeat(2,1fr)}}
  .card{background:#fff;border:1px solid var(--border);border-radius:16px;overflow:hidden;box-shadow:0 1px 2px rgba(0,0,0,.04)}
  .card-h{padding:10px 12px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap}
  .card-c{padding:10px 12px}
  .muted{color:#6b7280}
  .icon-card{display:flex;flex-direction:column;align-items:center;gap:8px;padding:16px;border:1px solid var(--border);border-radius:16px;background:#fff;cursor:pointer;transition:transform .1s ease, box-shadow .2s ease}
  .icon-card:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,.06)}
  .circle{width:54px;height:54px;border-radius:50%;display:grid;place-items:center;background:#e0e7ff;border:1px solid #c7d2fe;font-size:24px}
  .stat{background:#f8fafc;border:1px solid var(--border);border-radius:10px;padding:8px}
  .hidden{display:none !important}
  .badge{font-size:12px;border-radius:999px;padding:4px 8px;display:inline-block}
  .badge.success{background:#dcfce7;color:#166534}
  .badge.gray{background:#f3f4f6;color:#374151}
  table{width:100%;border-collapse:collapse;border:1px solid #e5e7eb}
  th,td{border:1px solid #e5e7eb;padding:6px}
  thead{background:#f8fafc}
  .ymbar{display:flex;gap:8px;align-items:center;margin-bottom:8px}
  .ymbar select{min-width:110px}
  .modal-wrap{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:100}
  .modal-wrap.show{display:flex}
  .modal-wrap .backdrop{position:absolute;inset:0;background:rgba(0,0,0,.25)}
  .modal-wrap .modal{position:relative;background:#fff;border-radius:16px;border:1px solid var(--border);width:min(820px,94vw);max-height:88vh;overflow:auto}
  .modal .head{display:flex;justify-content:space-between;align-items:center;padding:12px;border-bottom:1px solid var(--border)}
  .modal .body{padding:12px}
  .row{display:grid;gap:10px}
  .row.cols-2{grid-template-columns:1fr 1fr}
  .row.cols-3{grid-template-columns:repeat(3,1fr)}
  label{display:block;font-size:12px;color:#374151;margin-bottom:4px}
  input,select,textarea{width:100%;padding:10px;border:1px solid var(--border);border-radius:10px}
  .kv{display:flex;gap:12px;flex-wrap:wrap;color:#374151}
  .kv div{display:flex;align-items:center;gap:6px}
  .filters{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .chip{border:1px solid var(--border);padding:6px 10px;border-radius:14px;cursor:pointer}
  .chip.active{background:#e0e7ff;border-color:#c7d2fe}
</style>
<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&family=Noto+Naskh+Arabic:wght@400;600;700&display=swap" rel="stylesheet">
<style>

:root{
  --bg:#f7f9fb;
  --fg:#0f172a;
  --muted:#6b7280;
  --card:#ffffff;
  --border:#e5e7eb;
  --accent:#2563eb;
  --accent-2:#1d4ed8;
  --success:#16a34a;
  --danger:#ef4444;
  --warning:#f59e0b;
  --kpi-bg:#f8fafc;
  --chip:#eef2ff;
}

html,body{background:linear-gradient(180deg,#fbfcfe 0%,#f2f5f9 100%);}
body{
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  font-family: "Tajawal","Noto Naskh Arabic", system-ui, -apple-system, "Segoe UI", Roboto, "Tahoma", sans-serif;
  color:var(--fg);
}

/* Header */
header{
  position: sticky; top:0; z-index:50;
  background: rgba(255,255,255,.85);
  backdrop-filter: blur(8px);
  border-bottom:1px solid var(--border);
}
.brand span{letter-spacing:.2px}

/* Buttons */
.btn{ 
  border:1px solid var(--border);
  background:var(--card);
  border-radius:12px;
  padding:10px 14px;
  cursor:pointer;
  transition: all .15s ease;
}
.btn:hover{transform:translateY(-1px); box-shadow:0 6px 18px rgba(0,0,0,.06)}
.btn:active{transform:translateY(0)}
.btn.primary{ background:var(--accent); color:#fff; border-color:var(--accent) ; background:#1f6fff;color:#fff;border-color:#1f6fff}
.btn.primary:hover{ background:var(--accent-2); border-color:var(--accent-2) }
.btn.danger{ background:var(--danger); color:#fff; border-color:var(--danger) }
.btn.icon{ display:inline-flex; align-items:center; gap:8px }

/* Cards */
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:16px;
  box-shadow:0 1px 2px rgba(0,0,0,.04);
}
.card-h{ padding:12px 14px; border-bottom:1px solid var(--border) }
.card-c{ padding:12px 14px }

/* KPI tiles */
.stat{
  background:var(--kpi-bg);
  border:1px solid var(--border);
  border-radius:14px;
  padding:12px 14px;
  display:flex; align-items:center; gap:10px;
}
.stat i{ font-style:normal; font-size:18px; opacity:.8 }

/* Icon cards (buildings) */
.icon-card{
  border:1px solid var(--border);
  border-radius:16px;
  padding:16px;
  background:var(--card);
  transition:transform .12s ease, box-shadow .18s ease;
}
.icon-card:hover{ transform:translateY(-2px); box-shadow:0 10px 28px rgba(0,0,0,.07) }
.circle{ width:54px;height:54px;border-radius:50%;display:grid;place-items:center;
  background:#e0e7ff;border:1px solid #c7d2fe;font-size:22px }

/* Chips & filters */
.filters{ display:flex; gap:8px; flex-wrap:wrap; align-items:center }
.chip{
  border:1px solid var(--border); padding:6px 12px; border-radius:999px; cursor:pointer;
  background:#fff; transition:all .15s;
}
.chip:hover{ background:#f3f4f6 }
.chip.active{ background:var(--chip); border-color:#c7d2fe }

/* Inputs */
input,select,textarea{
  border:1px solid var(--border);
  border-radius:12px;
  padding:10px 12px;
  transition:border-color .15s, box-shadow .15s;
  background:#fff;
}
input:focus,select:focus,textarea:focus{ outline:none; border-color:#93c5fd; box-shadow:0 0 0 3px rgba(59,130,246,.15) }
label{ color:#374151; font-size:12px; margin-bottom:6px; display:block }

/* Tables */
table{ width:100%; border-collapse:collapse; border:1px solid var(--border); background:#fff }
th,td{ border:1px solid var(--border); padding:8px 10px }
thead{ background:#f8fafc }
tbody tr:nth-child(odd){ background:#fcfdff }
tbody tr:hover{ background:#f6faff }

/* Modals */
.modal-wrap .modal{ border-radius:18px }
.modal .head{ padding:14px; border-bottom:1px solid var(--border) }
.modal .body{ padding:14px }

/* Grids */
.grid{ display:grid; gap:12px }
@media(min-width:960px){ .grid.cols-3{ grid-template-columns:repeat(3,1fr) } }
@media(min-width:640px){ .grid.cols-2{ grid-template-columns:repeat(2,1fr) } }

/* Badges */
.badge{ font-size:12px; border-radius:999px; padding:4px 8px; display:inline-block }
.badge.success{ background:#dcfce7; color:#166534 }
.badge.gray{ background:#f3f4f6; color:#374151 }

/* Helpers */
.muted{ color:var(--muted) }
.kv{ display:flex; flex-wrap:wrap; gap:12px }
.container{ max-width:1200px; margin:0 auto; padding:14px }
.ymbar{ display:flex; gap:10px; align-items:center; margin-bottom:8px }
.hidden{ display:none !important }

/* Report: print-friendly */
@page{ size: A4; margin: 14mm }
@media print{
  header, .toolbar, .filters, .modal-wrap{ display:none !important }
  .card, .stat{ box-shadow:none }
  thead{ background:#fff !important }
  a[href]:after{ content:'' !important }
  .page-break{ page-break-before:always }
}

</style>

<style>
  #saveB{background:#1f6fff !important;color:#fff !important;border:1px solid #1f6fff !important}
  #saveB:hover{background:#1558d6 !important;border-color:#1558d6 !important}
</style>


<style>
  .topbar{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-bottom:12px}
  .topbar input[type="search"]{flex:1;min-width:220px;padding:10px 12px;border:1px solid #e5e7eb;border-radius:10px}
</style>
<script>
(function(){
  // Hook after dashboard render to attach filtering
  function attachBuildingSearch(){
    var input = document.getElementById('buildingSearch');
    var grid  = document.getElementById('buildingsGrid') || document.getElementById('buildingsList') || document.querySelector('[data-buildings-grid]');
    if(!input || !grid) return;
    input.oninput = function(){
      var q = (input.value||'').trim().toLowerCase();
      var cards = grid.querySelectorAll('[data-building-card]');
      cards.forEach(function(card){
        var txt = card.getAttribute('data-search') || card.textContent || '';
        txt = txt.toLowerCase();
        card.style.display = (q==='' || txt.indexOf(q) !== -1) ? '' : 'none';
      });
    };
  }
  window.__attachBuildingSearch = attachBuildingSearch;
})();
</script>


<style>
  .btn.primary{background:#1f6fff;color:#fff;border:1px solid #1f6fff;border-radius:8px;padding:8px 12px;cursor:pointer}
  .btn.primary:hover{background:#1558d6;border-color:#1558d6}
  .btn{display:inline-flex;align-items:center;gap:4px;font-size:14px}
</style>


<style>
  /* Unified blue style for modal buttons + primary buttons everywhere */
  .btn.primary{
    background:#1f6fff !important;
    color:#fff !important;
    border:1px solid #1f6fff !important;
    border-radius:8px !important;
    box-shadow:0 2px 6px rgba(31,111,255,0.25);
    transition:all .2s ease-in-out;
  }
  .btn.primary:hover{
    background:#1558d6 !important;
    border-color:#1558d6 !important;
    box-shadow:0 3px 8px rgba(21,88,214,0.35);
  }
  /* Make ALL modal buttons blue even if not marked as primary */
  .modal button.btn{
    background:#1f6fff !important;
    color:#fff !important;
    border:1px solid #1f6fff !important;
    border-radius:8px !important;
    box-shadow:0 2px 6px rgba(31,111,255,0.25);
    transition:all .2s ease-in-out;
  }
  .modal button.btn:hover{
    background:#1558d6 !important;
    border-color:#1558d6 !important;
    box-shadow:0 3px 8px rgba(21,88,214,0.35);
  }
</style>


<style>
  /* Expenses modal buttons: unified look */
  .btn.primary{background:#1f6fff !important;color:#fff !important;border:1px solid #1f6fff !important;border-radius:8px !important;box-shadow:0 2px 6px rgba(31,111,255,0.25);transition:all .2s ease-in-out}
  .btn.primary:hover{background:#1558d6 !important;border-color:#1558d6 !important;box-shadow:0 3px 8px rgba(21,88,214,0.35)}
  .btn.danger{background:#ef4444 !important;color:#fff !important;border:1px solid #ef4444 !important;border-radius:8px !important;box-shadow:0 2px 6px rgba(239,68,68,0.25);transition:all .2s ease-in-out}
  .btn.danger:hover{background:#dc2626 !important;border-color:#dc2626 !important;box-shadow:0 3px 8px rgba(220,38,38,0.35)}
  /* keep buttons inline & aligned */
  .modal .actions, .modal .footer, .modal .buttons-row {display:flex;gap:10px;flex-wrap:wrap;align-items:center}
</style>


<style>
  .btn.danger{background:#ef4444 !important;color:#fff !important;border:1px solid #ef4444 !important;border-radius:8px !important;box-shadow:0 2px 6px rgba(239,68,68,0.25);transition:all .2s ease-in-out}
  .btn.danger:hover{background:#dc2626 !important;border-color:#dc2626 !important;box-shadow:0 3px 8px rgba(220,38,38,0.35)}
  /* Ensure tenants action buttons are inline to the right */
  #tenantsList .actions{display:flex;gap:8px;align-items:center;justify-content:flex-end;flex-wrap:wrap}
</style>

<style>
/* --- injected: pay modal buttons row + sizing --- */
.modal .buttons-row{display:flex;align-items:center;gap:8px;justify-content:flex-end;margin-top:10px}
.modal .buttons-row .btn{width:auto !important;min-width:auto !important;display:inline-flex;align-items:center;justify-content:center;border-radius:10px;padding:10px 14px;font-size:14px}
.modal .buttons-row .btn.btn--sm{padding:8px 12px;font-size:13px}
/* --- end injected --- */
</style>
</head>
<body>
<style>
  body {
    direction: rtl;
    text-align: right;
    font-family: "Tajawal", "Noto Naskh Arabic", sans-serif;
    font-size: 15px;
    line-height: 1.6;
  }
  ul, li { list-style: none; margin: 0; padding: 0; }
  p { margin: 4px 0; }
</style>

<header>
  <div class="container" style="display:flex;align-items:center;justify-content:space-between;gap:12px">
    <div class="brand">
      <img src="https://i.ibb.co/C3rc2mkL/file-00000000637c62308240e62f076360cc.png" alt="Logo" onerror="this.style.display='none'">
      <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù…ØªÙ„ÙƒØ§Øª</span>
    </div>
    <div class="toolbar" style="display:flex;gap:10px;flex-wrap:wrap">
      <button type="button" class="btn  primary" onclick="openAddBuildingModal()">â• Ù…Ø¨Ù†Ù‰</button>
    </div>
  </div>
</header>

<main class="container">
  <div class="ymbar">
    <div>Ø§Ù„Ø³Ù†Ø©</div>
    <select id="yearSel"></select>
    <div>Ø§Ù„Ø´Ù‡Ø±</div>
    <select id="monthSel"></select>
  </div>

  <!-- KPI Ø¹Ø§Ù… -->
  <section class="grid cols-3" id="kpis">
    <div class="stat">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯ (Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯): <i>ï·¼</i> <b id="kpiIncome">0</b> Ø±.Ø¹</div>
    <div class="stat">Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª (Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯): <i>âˆ’</i> <b id="kpiExpenses">0</b> Ø±.Ø¹</div>
    <div class="stat">Ø§Ù„ØµØ§ÙÙŠ: <i>âœ“</i> <b id="kpiNet">0</b> Ø±.Ø¹</div>
  </section>

  <section id="view-dashboard" style="margin-top:10px">
    <div id="bizTabs" class="filters" style="margin:8px 0">
      <div class="chip active" data-biz="Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ</div>
      <div class="chip" data-biz="Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ">Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ</div>
    </div>

    <h2>Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ</h2>
    <div id="buildingsIcons" class="grid cols-3" id="buildingsGrid" data-buildings-grid></div>
    <div id="emptyBuildings" class="card" style="display:none">
      <div class="card-c muted" style="text-align:center;padding:24px">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¨Ø§Ù†Ù â€” Ø£Ø¶Ù Ù…Ø¨Ù†Ù‰ Ù…Ù† Ø£ÙŠÙ‚ÙˆÙ†Ø© (â• Ù…Ø¨Ù†Ù‰) Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰.</div>
    </div>
  </section>

  <section id="view-building" class="hidden">
    <div class="card">
      <div class="card-h">
        <div>
          <h2 id="buildingTitle" style="margin:0 0 4px"></h2>
          <div id="buildingMeta" class="kv muted" style="font-size:13px"></div>
        </div>
        <div style="display:flex;gap:8px">
          <button type="button" class="btn" onclick="renderDashboard()">Ø§Ù„Ø±Ø¬ÙˆØ¹</button>
          <button type="button" class="btn" id="btnEditBuilding">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¨Ù†Ù‰</button>
          <button type="button" class="btn" onclick="openImportCSV()">ğŸ“¥ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ø³ØªØ£Ø¬Ø±ÙŠÙ† (CSV)</button>
<button type="button" class="btn primary" onclick="openAddTenantModal()">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ£Ø¬Ø±</button>
          <button type="button" class="btn" onclick="openExpensesModal()">ğŸ’° Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</button>
          <button type="button" class="btn" onclick="renderReport()">ğŸ“Š ØªÙ‚Ø±ÙŠØ±</button>
        </div>
      </div>

      <!-- KPI Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ø¨Ù†Ù‰ Ù„Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯ -->
      <div class="card-c">
        <div class="grid cols-3" id="bldgKPI" style="margin-bottom:8px">
          <div class="stat">Ø¥ÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ø¨Ù†Ù‰ (Ø§Ù„Ø´Ù‡Ø±): <i>ï·¼</i> <b id="bkIncome">0</b> Ø±.Ø¹</div>
          <div class="stat">Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ù…Ø¨Ù†Ù‰ (Ø§Ù„Ø´Ù‡Ø±): <i>âˆ’</i> <b id="bkExpenses">0</b> Ø±.Ø¹</div>
          <div class="stat">Ø§Ù„ØµØ§ÙÙŠ (Ø§Ù„Ø´Ù‡Ø±): <i>âœ“</i> <b id="bkNet">0</b> Ø±.Ø¹</div>
        </div>

        <div class="grid cols-3">
          <div class="stat">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙˆØ­Ø¯Ø§Øª: <b id="stTotal">0</b></div>
          <div class="stat">Ø´Ù‚Ù‚: <b id="stApt">0</b></div>
          <div class="stat">Ù…Ø­Ù„Ø§Øª/Ù…Ø¹Ø§Ø±Ø¶: <b id="stShop">0</b></div>
          <div class="stat">Ù…Ø´ØºÙˆÙ„Ø©: <b id="stOcc">0</b></div>
          <div class="stat">Ø´Ø§ØºØ±Ø©: <b id="stVac">0</b></div>
          <div class="stat">ØªÙ†ØªÙ‡ÙŠ Ù‚Ø±ÙŠØ¨Ø§Ù‹ (â‰¤30 ÙŠÙˆÙ…): <b id="stExpSoon">0</b></div>
        </div>

        <!-- ÙÙ„Ø§ØªØ± ÙˆØ¨Ø­Ø« -->
        <div class="filters" style="margin:12px 0">
          <input id="searchBox" placeholder="Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…/Ø§Ù„ÙˆØ­Ø¯Ø©/Ø§Ù„Ù‡Ø§ØªÙ/Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©" style="max-width:260px">
          <div class="chip" data-ft="all">Ø§Ù„ÙƒÙ„</div>
          <div class="chip" data-ft="apartment">Ø´Ù‚Ù‚</div>
          <div class="chip" data-ft="shop">Ù…Ø­Ù„Ø§Øª</div>
          <div class="chip" data-ft="showroom">Ù…Ø¹Ø§Ø±Ø¶</div>
          <div class="chip" data-ft="basement">Ù‚Ø¨Ùˆ</div>
          <div class="chip" data-status="occupied">Ù…Ø´ØºÙˆÙ„Ø©</div>
          <div class="chip" data-status="vacant">Ø´Ø§ØºØ±Ø©</div>
        </div>

        <div class="grid cols-2" style="margin-top:12px">
          <div class="card">
            <div class="card-h"><b>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙˆØ­Ø¯Ø§Øª</b></div>
            <div class="card-c" id="unitsList"><span class="muted">â€”</span></div>
          </div>
          <div class="card">
            <div class="card-h"><b>Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±ÙˆÙ†</b></div>
            <div class="card-c" id="tenantsList"><span class="muted">â€”</span></div>
          </div>
        </div>
      </div>
    </div>
  </section>
</main>

<div id="modalWrap" class="modal-wrap" aria-hidden="true">
  <div class="backdrop" onclick="closeModal()"></div>
  <div class="modal" role="dialog" aria-modal="true">
    <div class="head">
      <h3 id="modalTitle">Ø¹Ù†ÙˆØ§Ù†</h3>
      <button type="button" class="btn" onclick="closeModal()">âœ•</button>
    </div>
    <div class="body" id="modalBody"></div>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

<script>
// ===================== Firebase =====================
const firebaseConfig={apiKey:"AIzaSyDE5ko6yQW5npxKWn0GUiz2NryqdOJUhOo",authDomain:"realestate-6b48f.firebaseapp.com",projectId:"realestate-6b48f",storageBucket:"realestate-6b48f.firebasestorage.app",messagingSenderId:"807500202227",appId:"1:807500202227:web:8333a119554122a36db786"};
try{firebase.initializeApp(firebaseConfig);}catch(e){}
const db=firebase.firestore();

// ===================== Helpers =====================
const $=(s,p=document)=>p.querySelector(s);
const todayIso=()=>new Date().toISOString().slice(0,10);
const fmtDate=d=>d?new Date(d).toLocaleDateString('ar-OM'):'';
const startOfMonth=(y,m)=>new Date(Date.UTC(y,m-1,1));
const endOfMonth=(y,m)=>new Date(Date.UTC(y,m,0,23,59,59));
const prevMonthEnd=(y,m)=>(m===1?endOfMonth(y-1,12):endOfMonth(y,m-1));
const isActiveDuring=(s,e,ms,me)=>new Date(s)<=me&&new Date(e)>=ms;
const num=v=>Number(v||0);

let activeBuildingId=null, selYear=new Date().getFullYear(), selMonth=new Date().getMonth()+1, chipsState={kind:'all',status:null}, cachedBuildings=[]; let bizTab='Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';

function populateYM(){
  const ys=$('#yearSel'),ms=$('#monthSel'); ys.innerHTML=''; ms.innerHTML='';
  for(let y=2018;y<=2036;y++){const o=document.createElement('option');o.value=y;o.textContent=y;if(y===selYear)o.selected=true;ys.appendChild(o)}
  const months=['ÙŠÙ†Ø§ÙŠØ±','ÙØ¨Ø±Ø§ÙŠØ±','Ù…Ø§Ø±Ø³','Ø£Ø¨Ø±ÙŠÙ„','Ù…Ø§ÙŠÙˆ','ÙŠÙˆÙ†ÙŠÙˆ','ÙŠÙˆÙ„ÙŠÙˆ','Ø£ØºØ³Ø·Ø³','Ø³Ø¨ØªÙ…Ø¨Ø±','Ø£ÙƒØªÙˆØ¨Ø±','Ù†ÙˆÙÙ…Ø¨Ø±','Ø¯ÙŠØ³Ù…Ø¨Ø±'];
  months.forEach((nm,i)=>{const o=document.createElement('option');o.value=i+1;o.textContent=nm;if(i+1===selMonth)o.selected=true;ms.appendChild(o)});
  ys.onchange=()=>{selYear=Number(ys.value);renderDashboard();

;(function(){
  var __orig = window.renderReport;
  window.renderReport = async function(){
    if(typeof __orig === 'function'){ await __orig(); }
  
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
      const ref = await db.collection('buildings').doc(activeBuildingId).get();
      const b = Object.assign({id: ref.id}, ref.data()||{});
      var root = document.getElementById('r_content');
      if(!root) return;
      var section = document.createElement('div');
      section.className = 'section';
      section.innerHTML = `
        <h3 style="margin:6px 0">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø¯Ù…Ø§Øª</h3>
        <table class="zebra">
          <thead><tr><th>Ø§Ù„ÙˆØµÙ</th><th>Ø§Ù„Ø±Ù‚Ù…</th></tr></thead>
          <tbody>
            <tr><td>Ø±Ù‚Ù… Ø­Ø³Ø§Ø¨ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡</td><td>${b.electricAccount||'â€”'}</td></tr>
            <tr><td>Ø±Ù‚Ù… Ø§Ù†ØªØ±Ù†Øª Ø§Ù„Ø¨Ù†Ø§ÙŠØ©</td><td>${b.internetNumber||'â€”'}</td></tr>
            <tr><td>Ø±Ù‚Ù… Ø­Ø§Ø±Ø³ Ø§Ù„Ø¨Ù†Ø§ÙŠØ©</td><td>${b.guardPhone||'â€”'}</td></tr>
            <tr><td>Ø±Ù‚Ù… Ø³Ø§Ø¦Ù‚ Ù†Ø§Ù‚Ù„Ø© Ø§Ù„Ù…Ø¬Ø§Ø±ÙŠ</td><td>${b.sewageTruckPhone||'â€”'}</td></tr>
          </tbody>
        </table>`;
      root.appendChild(section);
      if(typeof window.openReport === 'function'){ window.openReport(); }
    }catch(e){ console.warn('utilities section failed', e); }
  };
})();if(activeBuildingId)renderBuilding();};
  ms.onchange=()=>{selMonth=Number(ms.value);renderDashboard();if(activeBuildingId)renderBuilding();};
}

// ===================== Firestore wrappers =====================
async function listBuildings(){const snap=await db.collection('buildings').get();return snap.docs.map(d=>({id:d.id,...d.data()}));}
async function createBuilding(data){const ref=await db.collection('buildings').add(data);return ref.id;}
async function removeBuilding(id){await db.collection('buildings').doc(id).delete();}
async function listTenants(bid){const snap=await db.collection('buildings').doc(bid).collection('tenants').get();return snap.docs.map(d=>({id:d.id,...d.data()}));}
async function addTenantFS(bid,data){const ref=await db.collection('buildings').doc(bid).collection('tenants').add(data);return ref.id;}
async function updateTenantFS(bid,id,patch){await db.collection('buildings').doc(bid).collection('tenants').doc(id).update(patch);} 
async function deleteTenantFS(bid,id){await db.collection('buildings').doc(bid).collection('tenants').doc(id).delete();}
async function listExpenses(bid){const snap=await db.collection('buildings').doc(bid).collection('expenses').get();return snap.docs.map(d=>({id:d.id,...d.data()}));}
async function addExpenseFS(bid,data){const ref=await db.collection('buildings').doc(bid).collection('expenses').add(data);return ref.id;}
async function deleteExpenseFS(bid,id){await db.collection('buildings').doc(bid).collection('expenses').doc(id).delete();}
async function updateExpenseFS(bid,id,data){await db.collection('buildings').doc(bid).collection('expenses').doc(id).update(data);}
window.deleteExpenseRow=async function(id){await deleteExpenseFS(activeBuildingId,id);await renderExpensesTable();};
window.editExpenseRow = async function(id){

  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
    const doc = await db.collection('buildings').doc(activeBuildingId).collection('expenses').doc(id).get();
    if(!doc.exists){ alert('Ø§Ù„Ø³Ø¬Ù„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯'); return; }
    const e = Object.assign({id: doc.id}, doc.data()||{});
    openModal('ØªØ¹Ø¯ÙŠÙ„ Ù…ØµØ±ÙˆÙ', `
      <div class="row cols-2">
        <div><label>Ù†ÙˆØ¹ Ø§Ù„Ù…ØµØ±ÙˆÙ</label><input id="edType" value="${e.type||''}"></div>
        <div><label>Ø§Ù„Ù…Ø¨Ù„Øº (Ø±.Ø¹)</label><input id="edAmount" type="number" step="0.001" value="${Number(e.amount||0)}"></div>
        <div><label>Ø§Ù„ØªØ§Ø±ÙŠØ®</label><input id="edDate" type="date" value="${(e.date||'').slice(0,10)}"></div>
        <div style="grid-column:1/-1"><label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label><textarea id="edNotes" rows="2">${e.notes||''}</textarea></div>
      </div>
      <div class="row" style="grid-template-columns:1fr auto"><div></div><button type="button" class="btn primary" id="edSave">Ø­ÙØ¸</button></div>
    `);
    document.getElementById('edSave').onclick = async ()=>{
      const patch = {
        type: document.getElementById('edType').value.trim(),
        amount: Number(document.getElementById('edAmount').value||0),
        date: document.getElementById('edDate').value,
        notes: document.getElementById('edNotes').value.trim()
      };
      await updateExpenseFS(activeBuildingId, id, patch);
      closeModal();
      await renderExpensesTable();
    };
  }catch(err){ console.error(err); alert('ØªØ¹Ø°Ø± ÙØªØ­ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„'); }
};
function editExpense(index){
  const e = currentBuilding.expenses[index];
  openModal('ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…ØµØ±ÙˆÙ', `
    <div><label>Ø§Ù„Ø®Ø¯Ù…Ø©</label><input id="exType" value="${e.type||''}"></div>
    <div><label>Ø§Ù„Ù‚ÙŠÙ…Ø©</label><input id="exAmount" type="number" value="${e.amount||0}"></div>
    <div><label>Ø§Ù„ØªØ§Ø±ÙŠØ®</label><input id="exDate" type="date" value="${e.date||''}"></div>
    <div><label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label><textarea id="exNotes">${e.notes||''}</textarea></div>
    <button class="btn primary" onclick="saveExpense(${index})">ğŸ’¾ Ø­ÙØ¸</button>
  `);
}

async function saveExpense(index){
  const patch = {
    type: $('#exType').value.trim(),
    amount: Number($('#exAmount').value||0),
    date: $('#exDate').value,
    notes: $('#exNotes').value.trim()
  };
  currentBuilding.expenses[index] = patch;
  await db.collection('buildings').doc(activeBuildingId).update({ expenses: currentBuilding.expenses });
  closeModal();
  renderBuilding();
}


// ===================== Dashboard =====================
async function renderDashboard(){
  $('#view-dashboard').classList.remove('hidden');$('#view-building').classList.add('hidden');
  const el=document.getElementById('buildingsIcons');el.innerHTML='';

  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
    
const buildings=await listBuildings();cachedBuildings=buildings;
// Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø§Ø¯ ÙƒÙ„ ÙØ¦Ø©
try{
  var __countMap = {'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ':0,'Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ':0};
  buildings.forEach(function(b){
    var k = (b.bizType || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ');
    if(__countMap[k] == null) __countMap[k] = 0;
    __countMap[k]++;
  });
  var __tabs = document.getElementById('bizTabs');
  if(__tabs){
    __tabs.querySelectorAll('.chip[data-biz]').forEach(function(ch){
      var k = ch.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
      var base = k;
      var n = __countMap[k] || 0;
      ch.textContent = base + ' (' + n + ')';
      // Ø¥Ø¹Ø§Ø¯Ø© class active Ø¹Ù†Ø¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø©
      if(k === bizTab){ ch.classList.add('active'); }
    });
  }
}catch(__e){}
const filteredBuildings = buildings.filter(b => (b.bizType || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ')===bizTab);

    document.getElementById('emptyBuildings').style.display=(filteredBuildings.length?'none':'block');
    filteredBuildings.forEach(b=>{
      const card=document.createElement('div');card.className='icon-card';card.setAttribute('data-building-card','');card.setAttribute('data-bid', b.id);
      const counts=b.counts||{};
      card.innerHTML=`
        <div class="circle">ğŸ¢</div>
        <div style="font-weight:700">${b.name||''}</div>
        <div class="muted" style="font-size:12px">${b.owner? 'ğŸ‘¤ Ø§Ù„Ù…Ø§Ù„Ùƒ: '+b.owner : ''}</div>
        <div class="muted" style="font-size:12px">${b.location? 'ğŸ“ '+b.location : ''}</div>
        <div class="muted" style="font-size:12px">${b.contact? 'â˜ï¸ '+b.contact : ''}</div>
        ${b.notes? `<div class="muted" style="font-size:12px">${b.notes}</div>`:''}
        <div class="muted" style="font-size:12px">Ø§Ù„ÙˆØ­Ø¯Ø§Øª: ${num(counts.apartments)+num(counts.shops)+num(counts.showrooms)+num(counts.basements) || 0}</div>
        <div style="display:flex;gap:6px;margin-top:8px">
          <button type="button" class="btn" data-act="open">ÙØªØ­</button>
          <button type="button" class="btn" data-act="add">Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ£Ø¬Ø±</button>
          <button type="button" class="btn" data-act="edit">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
          <button type="button" class="btn  danger" data-act="del">Ø­Ø°Ù</button>
        </div>`;
      card.querySelector('[data-act="open"]').onclick=async()=>{activeBuildingId=b.id;await renderBuilding();};
      card.querySelector('[data-act="add"]').onclick=async()=>{activeBuildingId=b.id;openAddTenantModal();};
      card.querySelector('[data-act="del"]').onclick=async()=>{if(confirm('Ø­Ø°Ù Ø§Ù„Ù…Ø¨Ù†Ù‰ØŸ')){await removeBuilding(b.id);renderDashboard();}};
      card.setAttribute('data-building-card','');try{card.setAttribute('data-search',(b.name||'')+' '+(b.location||'')+' '+(b.contact||''));}catch(_){}
el.appendChild(card);
    });
    // KPI Ø¹Ø§Ù…
    let income=0,expenses=0;
    for(const b of buildings){
      const tenants=await listTenants(b.id);
      const ms=startOfMonth(selYear,selMonth),me=endOfMonth(selYear,selMonth);
  // Ø§Ø¹Ø¯Ø§Ø¯ Ø²Ø± ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¨Ù†Ù‰ Ù„ÙŠØ³ØªØ®Ø¯Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨Ù†Ù‰ Ø§Ù„Ø­Ø§Ù„ÙŠØ©

  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
    var __editBtn = document.getElementById('btnEditBuilding');
    if(__editBtn){ __editBtn.onclick = function(){ openEditBuildingModal(window.currentBuilding || b); }; }
  }catch(__e){}

      income+=tenants.filter(t=>isActiveDuring(t.startDate,t.endDate,ms,me)).reduce((s,t)=>s+num(t.rent),0);
      const exps=await listExpenses(b.id);
      expenses+=exps.filter(e=>isActiveDuring(e.date,e.date,ms,me)).reduce((s,e)=>s+num(e.amount),0);
    }
    $('#kpiIncome').textContent=income.toFixed(2);
    $('#kpiExpenses').textContent=expenses.toFixed(2);
    $('#kpiNet').textContent=(income-expenses).toFixed(2);
  }catch(err){console.error(err);document.getElementById('emptyBuildings').style.display='block';document.querySelector('#emptyBuildings .card-c').textContent='ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ.';}
}
function ymKey(y,m){return String(y).padStart(4,'0')+'-'+String(m).padStart(2,'0');}
window.renderDashboard=renderDashboard; window.bizTab = bizTab;

// Delegate clicks for building card actions to avoid missing handlers
(function(){
  var grid = document.getElementById('buildingsIcons');
  if(grid && !grid.__actionsDelegated){
    grid.addEventListener('click', async function(e){
      var btn = e.target.closest('[data-act]');
      if(!btn) return;
      var card = btn.closest('[data-building-card]');
      var bid = card && card.getAttribute('data-bid');
      if(!bid) return;
      if(btn.matches('[data-act="edit"]')){
      
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
          activeBuildingId = bid;
          const ref = await db.collection('buildings').doc(bid).get();
          const b = Object.assign({id: ref.id}, ref.data()||{});
          openEditBuildingModal(b);
        }catch(err){ console.error(err); alert('ØªØ¹Ø°Ø± ÙØªØ­ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„'); }
      }
    }, false);
    grid.__actionsDelegated = true;
  }
})();


function openUpsertBuildingModal(mode, existing){
  const isEdit = mode === 'edit';
  const b = existing || {};
  const counts = b.counts || {apartments:0,shops:0,showrooms:0,basements:0};
  const bizType = b.bizType || (window.bizTab || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ');
  const feeType = b.feeType || 'percentage';
  const feeValue = (b.feeValue!=null ? b.feeValue : '');
  const electricAccount = b.electricAccount || '';
  const internetNumber = b.internetNumber || '';
  const guardPhone = b.guardPhone || '';
  const sewageTruckPhone = b.sewageTruckPhone || '';

  openModal(isEdit ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¨Ù†Ù‰' : 'Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù†Ù‰', `
    <div class="row">
      <div class="row cols-2">
        <div>
          <label>Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„</label>
          <select id="mbBizType">
            <option value="Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ" ${bizType==='Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ'?'selected':''}>Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ</option>
            <option value="Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ" ${bizType==='Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ'?'selected':''}>Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ</option>
          </select>
        </div>
        <div>
          <label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø£Ø¬Ø±Ø©</label>
          <select id="mbFeeType">
            <option value="percentage" ${feeType==='percentage'?'selected':''}>Ù†Ø³Ø¨Ø©</option>
            <option value="salary" ${feeType==='salary'?'selected':''}>Ø±Ø§ØªØ¨</option>
          </select>
        </div>
      </div>
      <div>
        <label id="mbFeeLabel">${feeType==='salary'?'Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ (Ø±.Ø¹)':'Ø§Ù„Ù†Ø³Ø¨Ø© (%)'}</label>
        <input id="mbFeeValue" type="number" inputmode="decimal" step="0.01" value="${feeValue}" placeholder="${feeType==='salary'?'Ù…Ø«Ø§Ù„: 150 (Ø±.Ø¹)':'Ù…Ø«Ø§Ù„: 15 (Ùª)'}">
        <small style="display:block;color:#6b7280;margin-top:4px">Ø¥Ù† Ø§Ø®ØªØ±Øª "Ù†Ø³Ø¨Ø©" ØªÙØ­Ø³ÙØ¨ Ù…Ù† Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ¬Ø§Ø± Ø§Ù„Ø´Ù‡Ø±ÙŠ. ÙˆØ¥Ù† Ø§Ø®ØªØ±Øª "Ø±Ø§ØªØ¨" ØªÙØ®ØµÙ… Ø§Ù„Ù‚ÙŠÙ…Ø© Ù…Ø¨Ø§Ø´Ø±Ø©.</small>
      </div>

      <div><label>Ø§Ø³Ù… Ø§Ù„Ù…Ø¨Ù†Ù‰</label><input id="mbName" value="${b.name||''}" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø¨Ù†Ù‰ Ø§Ù„Ø³ÙŠÙØ©"></div>
      <div class="row cols-2">
        <div><label>Ø§Ù„Ù…ÙˆÙ‚Ø¹</label><input id="mbLocation" value="${b.location||''}" placeholder="Ù…Ø«Ø§Ù„: ÙˆÙ„Ø§ÙŠØ© ØµÙˆØ± - Ø§Ù„Ø³ÙŠÙØ©"></div>
        <div><label>Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„</label><input id="mbContact" inputmode="tel" value="${b.contact||''}" placeholder="9xxxxxxx"></div>
      </div>
      <div><label>Ø§Ù„Ù…Ø§Ù„Ùƒ</label><input id="mbOwner" value="${b.owner||''}" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ù„Ùƒ"></div>
      <div><label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label><textarea id="mbNotes" rows="2" placeholder="ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©">${b.notes||''}</textarea></div>

      <div class="row cols-2">
        <div><label>Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ù‚Ù‚</label><input id="mbApt" type="number" min="0" value="${Number(counts.apartments||0)}"></div>
        <div><label>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ù„Ø§Øª</label><input id="mbShop" type="number" min="0" value="${Number(counts.shops||0)}"></div>
        <div><label>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§Ø±Ø¶</label><input id="mbShow" type="number" min="0" value="${Number(counts.showrooms||0)}"></div>
        <div><label>Ø¹Ø¯Ø¯ Ø§Ù„Ù‚Ø¨Ùˆ</label><input id="mbBase" type="number" min="0" value="${Number(counts.basements||0)}"></div>
      </div>

      <div class="row cols-2">
        <div><label>Ø±Ù‚Ù… Ø­Ø³Ø§Ø¨ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡</label><input id="mbElectric" value="${electricAccount}" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨"></div>
        <div><label>Ø±Ù‚Ù… Ø§Ù†ØªØ±Ù†Øª Ø§Ù„Ø¨Ù†Ø§ÙŠØ©</label><input id="mbInternet" value="${internetNumber}" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ/Ø§Ù„Ø­Ø³Ø§Ø¨"></div>
        <div><label>Ø±Ù‚Ù… Ø­Ø§Ø±Ø³ Ø§Ù„Ø¨Ù†Ø§ÙŠØ©</label><input id="mbGuard" value="${guardPhone}" placeholder="Ù‡Ø§ØªÙ Ø§Ù„Ø­Ø§Ø±Ø³"></div>
        <div><label>Ø±Ù‚Ù… Ø³Ø§Ø¦Ù‚ Ù†Ø§Ù‚Ù„Ø© Ø§Ù„Ù…Ø¬Ø§Ø±ÙŠ</label><input id="mbSewage" value="${sewageTruckPhone}" placeholder="Ù‡Ø§ØªÙ Ø§Ù„Ø³Ø§Ø¦Ù‚"></div>
      </div>
    </div>
    <div class="row" style="grid-template-columns:auto auto;justify-content:flex-end">
      <button type="button" class="btn primary" id="saveB">${isEdit?'ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„':'Ø­ÙØ¸ Ø§Ù„Ù…Ø¨Ù†Ù‰'}</button>
    </div>`);

  const feeSel = document.getElementById('mbFeeType');
  if(feeSel){
    feeSel.onchange = function(){
      const isSalary = this.value==='salary';
      document.getElementById('mbFeeLabel').textContent = isSalary ? 'Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ (Ø±.Ø¹)' : 'Ø§Ù„Ù†Ø³Ø¨Ø© (%)';
      const iv = document.getElementById('mbFeeValue');
      if(iv){ iv.placeholder = isSalary ? 'Ù…Ø«Ø§Ù„: 150 (Ø±.Ø¹)' : 'Ù…Ø«Ø§Ù„: 15 (Ùª)'; }
    };
  }

  const saveBtn = document.getElementById('saveB');
  if(saveBtn){
    saveBtn.onclick = async ()=>{
      const payload = {
        bizType: document.getElementById('mbBizType').value,
        feeType: document.getElementById('mbFeeType').value,
        feeValue: Number(document.getElementById('mbFeeValue').value||0),
        name: (document.getElementById('mbName').value||'').trim(),
        location: (document.getElementById('mbLocation').value||'').trim(),
        contact: (document.getElementById('mbContact').value||'').trim(),
        owner: (document.getElementById('mbOwner').value||'').trim(),
        notes: (document.getElementById('mbNotes').value||'').trim(),
        counts: {
          apartments: Number(document.getElementById('mbApt').value||0),
          shops: Number(document.getElementById('mbShop').value||0),
          showrooms: Number(document.getElementById('mbShow').value||0),
          basements: Number(document.getElementById('mbBase').value||0),
        },
        electricAccount: (document.getElementById('mbElectric').value||'').trim(),
        internetNumber: (document.getElementById('mbInternet').value||'').trim(),
        guardPhone: (document.getElementById('mbGuard').value||'').trim(),
        sewageTruckPhone: (document.getElementById('mbSewage').value||'').trim(),
      };
      if(!payload.name){ alert('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¨Ù†Ù‰'); return; }

      if(isEdit){
        const id = (b && b.id) || activeBuildingId;
        await db.collection('buildings').doc(id).update(payload);
      }else{
        await createBuilding(Object.assign({createdAt:new Date().toISOString()}, payload));
      }
      closeModal();
      renderDashboard();
      if(activeBuildingId) renderBuilding();
    };
  }
}



// ===================== Building view =====================
function unitKindLabel(kind){return kind==='apartment'?'Ø´Ù‚Ø©':(kind==='shop'?'Ù…Ø­Ù„':(kind==='showroom'?'Ù…Ø¹Ø±Ø¶':'Ù‚Ø¨Ùˆ'));}

// Add building modal â€” ÙŠØªØ¶Ù…Ù† Ø®Ø§Ù†Ø© "Ø§Ù„Ù…Ø§Ù„Ùƒ"
function openAddBuildingModal(){ openUpsertBuildingModal("add"); }
window.openAddBuildingModal = openAddBuildingModal;
function openEditBuildingModal(bData){ openUpsertBuildingModal('edit', bData); }
window.openEditBuildingModal = openEditBuildingModal;


async function renderBuilding(){
  $('#view-dashboard').classList.add('hidden');const wrap=$('#view-building');wrap.classList.remove('hidden');
  const bRef=await db.collection('buildings').doc(activeBuildingId).get();const b={id:bRef.id,...bRef.data()};
  window.activeBuildingId = b.id; window.currentBuilding = b;

  $('#buildingTitle').textContent=b.name||'';
  $('#buildingMeta').innerHTML=`${b.owner?`<div>ğŸ‘¤ <span>${b.owner}</span></div>`:''}${b.location?`<div>ğŸ“ <span>${b.location}</span></div>`:''}${b.contact?`<div>â˜ï¸ <span>${b.contact}</span></div>`:''}${b.notes?`<div>ğŸ“ <span>${b.notes}</span></div>`:''}${b.electricAccount?`<div>âš¡ <span>${b.electricAccount}</span></div>`:''}${b.internetNumber?`<div>ğŸŒ <span>${b.internetNumber}</span></div>`:''}${b.guardPhone?`<div>ğŸ‘® <span>${b.guardPhone}</span></div>`:''}${b.sewageTruckPhone?`<div>ğŸš› <span>${b.sewageTruckPhone}</span></div>`:''}`;

  const ms=startOfMonth(selYear,selMonth),me=endOfMonth(selYear,selMonth);
  // Ø§Ø¹Ø¯Ø§Ø¯ Ø²Ø± ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¨Ù†Ù‰ Ù„ÙŠØ³ØªØ®Ø¯Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨Ù†Ù‰ Ø§Ù„Ø­Ø§Ù„ÙŠØ©

  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
    var __editBtn = document.getElementById('btnEditBuilding');
    if(__editBtn){ __editBtn.onclick = function(){ openEditBuildingModal(window.currentBuilding || b); }; }
  }catch(__e){}

  const tenantsAll=await listTenants(b.id); const tenants=tenantsAll.filter(t=>isActiveDuring(t.startDate,t.endDate,ms,me));
  const tenantsSorted = (window.sortUnitsByKindAndNumber? window.sortUnitsByKindAndNumber(tenants) : tenants);
const expensesAll=await listExpenses(b.id); const expenses=expensesAll.filter(e=>isActiveDuring(e.date,e.date,ms,me));
  const inc=tenants.reduce((s,t)=>s+num(t.rent),0), ex=expenses.reduce((s,e)=>s+num(e.amount),0);
  $('#bkIncome').textContent=inc.toFixed(2);
  $('#bkExpenses').textContent=ex.toFixed(2);
  $('#bkNet').textContent=(inc-ex).toFixed(2);

  const counts=b.counts||{apartments:0,shops:0,showrooms:0,basements:0};
  const totalUnits=num(counts.apartments)+num(counts.shops)+num(counts.showrooms)+num(counts.basements);
  $('#stTotal').textContent=totalUnits; $('#stApt').textContent=num(counts.apartments); $('#stShop').textContent=num(counts.shops)+num(counts.showrooms);
  $('#stOcc').textContent=tenants.length; $('#stVac').textContent=Math.max(0,totalUnits-tenants.length);
  $('#stExpSoon').textContent=tenants.filter(t=>new Date(t.endDate)<=endOfMonth(selYear,selMonth+1)).length;

  // Filters & search
  const searchBox=$('#searchBox'); const chips=document.querySelectorAll('.chip');
  chips.forEach(ch=>{ ch.onclick=()=>{
      if(ch.dataset.ft) chipsState.kind=ch.dataset.ft;
      if(ch.dataset.status) chipsState.status=(chipsState.status===ch.dataset.status?null:ch.dataset.status);
      chips.forEach(x=>x.classList.remove('active'));
      document.querySelectorAll(`.chip[data-ft="${chipsState.kind}"]`).forEach(x=>x.classList.add('active'));
      if(chipsState.status){ document.querySelectorAll(`.chip[data-status="${chipsState.status}"]`).forEach(x=>x.classList.add('active')); }
      renderLists();
  };});
  searchBox.oninput=()=>renderLists();

  function renderLists(){
    const q=(searchBox.value||'').trim().toLowerCase();
    const filtered=tenants.filter(t=>{ 
      if(chipsState.kind!=='all'){ if(chipsState.kind==='shop'){ if(!(t.kind==='shop'||t.kind==='showroom')) return false; } else if(t.kind!==chipsState.kind) return false; }
      const bag=`${t.unitNumber||''} ${t.tenantName||''} ${t.phone||''} ${t.nationalId||''}`.toLowerCase();
      return !q || bag.includes(q);
    });
    
    // --- sort by kind then unitNumber ascending ---
    (function(){
      const kindOrder = { apartment:1, shop:2, showroom:3, basement:4 };
      function numLike(v){
        if(v==null) return Number.POSITIVE_INFINITY;
        const m = String(v).match(/\d+/);
        return m ? parseInt(m[0],10) : Number.POSITIVE_INFINITY;
      }
      filtered.sort((a,b)=>{
        const pa = kindOrder[a && a.kind] || 99;
        const pb = kindOrder[b && b.kind] || 99;
        if(pa!==pb) return pa - pb;
        const na = numLike(a && a.unitNumber);
        const nb = numLike(b && b.unitNumber);
        if(na!==nb) return na - nb;
        const ta = (a && a.tenantName || '').toString();
        const tb = (b && b.tenantName || '').toString();
        return ta.localeCompare(tb, 'ar');
      });
    })();
    const tenantsBox=$('#tenantsList'); tenantsBox.innerHTML=''; if(!filtered.length) tenantsBox.innerHTML='<div class="muted">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ£Ø¬Ø±ÙˆÙ† Ø­Ø³Ø¨ Ø§Ù„ØªØµÙÙŠØ©.</div>';
    filtered.forEach(t=>{ const row=document.createElement('div'); row.style.cssText='border:1px solid var(--border);border-radius:12px;padding:12px;margin-bottom:8px;background:#ecfdf5';
      const natPart = t.nationalId ? (' â€¢ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©: '+t.nationalId) : '';
      row.innerHTML=`<div style="display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap">
          <div><div style="font-weight:600">${t.tenantName} ${(t.payments && t.payments[ymKey(selYear, selMonth)]) ? '<span style="color:#22bb33;font-weight:bold;font-size:16px">âœ”ï¸</span>' : ''} <span class="muted">(${t.unitNumber||'â€”'})</span> <span class="badge success">Ù…Ø´ØºÙˆÙ„Ø©</span></div>
          <div class="muted" style="font-size:12px">${unitKindLabel(t.kind)} â€¢ Ø¥ÙŠØ¬Ø§Ø±: ${t.rent} â€¢ Ù‡Ø§ØªÙ: ${t.phone||'â€”'}${natPart}</div>
          <div class="muted" style="font-size:12px">Ù…Ù† ${fmtDate(t.startDate)} Ø¥Ù„Ù‰ ${fmtDate(t.endDate)}</div></div>
          <div style="display:flex;gap:6px;justify-content:flex-end;align-items:flex-start">
  <div class="tenant-actions" style="display:flex;flex-direction:column;gap:6px">
    <button type="button" class="primary exp-edit btn" data-edit>âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
    <button type="button" class="btn" data-act="pay-tenant" data-tenant-id="${t.id}" data-bid="${b.id}">ğŸ’³ Ø¯ÙØ¹</button>
  </div>
  <button type="button" class="danger exp-delete btn danger" data-del>ğŸ—‘ï¸ Ø­Ø°Ù</button>
</div></div>${t.notes? `<div class="muted" style="font-size:12px;margin-top:4px">Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${t.notes}</div>`:''}`;
      // --- Ø¹Ø±Ø¶ Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„Ø¯ÙØ¹ Ù„Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯ Ø¯Ø§Ø®Ù„ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø± ---
    
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
        const __payNote = t && t.payments && t.payments[ymKey(selYear, selMonth)];
        if(__payNote){
          const __noteDiv = document.createElement('div');
          __noteDiv.className = 'muted';
          __noteDiv.style.cssText = 'font-size:12px;margin-top:4px;color:#1558d6';
          __noteDiv.textContent = 'ğŸ’¬ Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„Ø¯ÙØ¹: ' + __payNote;
          row.appendChild(__noteDiv);
        }
      }catch(__e){ /* ignore */ }
      // --- Ù†Ù‡Ø§ÙŠØ© Ø¹Ø±Ø¶ Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„Ø¯ÙØ¹ ---

      row.querySelector('[data-del]').onclick=async()=>{ if(!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±ØŸ')){return;} const mStart=startOfMonth(selYear,selMonth);const pEnd=prevMonthEnd(selYear,selMonth);
        if(new Date(t.startDate)<mStart){await updateTenantFS(b.id,t.id,{endDate:pEnd.toISOString().slice(0,10)});}else{await deleteTenantFS(b.id,t.id);} renderBuilding();
      };

var __payBtn=row.querySelector('[data-act="pay-tenant"]'); if(__payBtn) __payBtn.onclick=async()=>{

  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
    const bid = b.id;
    const tid = t.id;
    const ym = (typeof selYear!=='undefined' && typeof selMonth!=='undefined') ? ymKey(selYear, selMonth) : (new Date().toISOString().slice(0,7));
    // expose current tenant/building for receipt
  
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
      window.currentTenant = {
        id: tid,
        tenantName: t.tenantName || t.name || '',
        name: t.tenantName || t.name || '',
        unitNumber: t.unitNumber || '',
        unit: { number: t.unitNumber || '' }
      };
      window.currentBuilding = { id: bid, name: (b && b.name) || '' };
      window.selectedYearMonth = ym;
    }catch(_e){}
    
    openModal('ØªØ³Ø¬ÙŠÙ„ Ø¯ÙØ¹', `
      <div class="row">
        <div style="grid-column:1/-1">
          <label>Ù…Ù„Ø§Ø­Ø¸Ø©/Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¯ÙØ¹ (${ym})</label>
          <textarea id="payNote" rows="3" placeholder="Ù…Ø«Ø§Ù„: 280 Ù…Ù‚Ø¯Ù‘Ù… Ø£Ùˆ 200 Ù…Ø¤Ø®Ø±"></textarea>
        </div>
      </div>
      <div class="row" style="grid-template-columns:1fr auto">
        <div></div><button type="button" class="btn primary" id="savePay">Ø­ÙØ¸</button>
      </div>`);
    // Prefill last note if exists
  
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
      const tdoc = await db.collection('buildings').doc(bid).collection('tenants').doc(tid).get();
      const tdata = tdoc.exists ? tdoc.data() : {};
      const prev = tdata && tdata.payments && tdata.payments[ym];
      if(prev) document.getElementById('payNote').value = prev;
    }catch(e){}
    document.getElementById('savePay').onclick = async ()=>{
      const note = (document.getElementById('payNote').value||'').trim();
      const field = {}; field['payments.'+ym] = note || null;
      await updateTenantFS(bid, tid, field);
      // ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø²Ø± Ø¥ØµØ¯Ø§Ø± Ø¥ÙŠØµØ§Ù„ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
      // Ù†Ø­ØªÙØ¸ Ø¨Ø§Ù„Ø­ÙØ¸ ÙÙ‚Ø· ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
      if(typeof renderBuilding==='function') renderBuilding();
    };
  }catch(err){ console.error(err); alert('ØªØ¹Ø°Ø± Ø­ÙØ¸ Ø§Ù„Ø¯ÙØ¹'); }
};

      row.querySelector('[data-edit]').onclick=()=>{openModal('ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø± (Ø³Ø§Ø±ÙŠ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±)',`
          <div class="row cols-2">
            <div><label>Ù†ÙˆØ¹ Ø§Ù„ÙˆØ­Ø¯Ø©</label><select id="etKind">
              <option value="apartment" ${t.kind==='apartment'?'selected':''}>Ø´Ù‚Ø©</option>
              <option value="shop" ${t.kind==='shop'?'selected':''}>Ù…Ø­Ù„</option>
              <option value="showroom" ${t.kind==='showroom'?'selected':''}>Ù…Ø¹Ø±Ø¶</option>
              <option value="basement" ${t.kind==='basement'?'selected':''}>Ù‚Ø¨Ùˆ</option>
            </select></div>
            <div><label>Ø±Ù‚Ù… Ø§Ù„Ø´Ù‚Ø©/Ø§Ù„Ù…Ø­Ù„</label><input id="etUnit" value="${t.unitNumber||''}"></div>
            <div><label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±</label><input id="etName" value="${t.tenantName||''}"></div>
            <div><label>Ø§Ù„Ø¥ÙŠØ¬Ø§Ø± Ø§Ù„Ø´Ù‡Ø±ÙŠ (Ø±.Ø¹)</label><input id="etRent" type="number" step="0.001" value="${t.rent||0}"></div>
            <div><label>Ø§Ù„Ù‡Ø§ØªÙ</label><input id="etPhone" type="tel" value="${t.phone||''}"></div>
            <div><label>Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©</label><input id="etNatId" value="${t.nationalId||''}" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©"></div>
            <div><label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</label><input id="etEnd" type="date" value="${t.endDate||''}"></div>
            <div style="grid-column:1/-1"><label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label><textarea id="etNotes" rows="3">${t.notes||''}</textarea></div>
          </div>
          <div class="row" style="grid-template-columns:1fr auto"><div></div><button type="button" class="btn primary" id="etSave">Ø­ÙØ¸</button></div>`);
        $('#etSave').onclick=async()=>{const patch={kind:$('#etKind').value,unitNumber:$('#etUnit').value.trim(),tenantName:$('#etName').value.trim(),rent:Number($('#etRent').value||0),phone:$('#etPhone').value.trim(),nationalId:$('#etNatId').value.trim(),notes:$('#etNotes').value.trim(),endDate:$('#etEnd').value, rentPayTiming: (document.getElementById('etPayTiming') ? document.getElementById('etPayTiming').value : (t.rentPayTiming||''))};
          if(new Date(t.startDate)<startOfMonth(selYear,selMonth)){await updateTenantFS(b.id,t.id,{endDate:prevMonthEnd(selYear,selMonth).toISOString().slice(0,10)});await addTenantFS(b.id,{...patch,startDate:startOfMonth(selYear,selMonth).toISOString().slice(0,10)});}else{await updateTenantFS(b.id,t.id,{...patch});}
          closeModal();renderBuilding();};
      };
      tenantsBox.appendChild(row);
    });
    const unitsBox=$('#unitsList');unitsBox.innerHTML=''; tenantsSorted.forEach(t=>{const li=document.createElement('div');li.style.cssText='display:flex;justify-content:space-between;align-items:center;border:1px solid var(--border);border-radius:10px;padding:8px;margin-bottom:8px';
      li.innerHTML=`<div>Ø§Ù„ÙˆØ­Ø¯Ø© <b>${t.unitNumber||'â€”'}</b> â€” ${unitKindLabel(t.kind)}</div><div><span class="badge success">Ù…Ø´ØºÙˆÙ„Ø©</span></div>`; unitsBox.appendChild(li);
    });
    const vacant=Math.max(0,totalUnits-tenants.length); const liVac=document.createElement('div'); liVac.style.cssText='display:flex;justify-content:space-between;align-items:center;border:1px dashed var(--border);border-radius:10px;padding:8px;margin-bottom:8px;background:#fff';
    liVac.innerHTML=`<div>ÙˆØ­Ø¯Ø§Øª Ø´Ø§ØºØ±Ø©</div><div><span class="badge gray">${vacant}</span></div>`; unitsBox.appendChild(liVac);
  }
  renderLists();
}

// ===================== Tenants (Add) =====================
function openAddTenantModal(){ 
  openModal('Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ£Ø¬Ø±', `
    <div class="row cols-2">
      <div><label>Ù†ÙˆØ¹ Ø§Ù„ÙˆØ­Ø¯Ø©</label>
        <select id="tKind">
          <option value="apartment">Ø´Ù‚Ø©</option>
          <option value="shop">Ù…Ø­Ù„</option>
          <option value="showroom">Ù…Ø¹Ø±Ø¶</option>
          <option value="basement">Ù‚Ø¨Ùˆ</option>
        </select>
      </div>
      <div><label>Ø±Ù‚Ù… Ø§Ù„Ø´Ù‚Ø©/Ø§Ù„Ù…Ø­Ù„</label><input id="tUnit" placeholder="Ù…Ø«Ø§Ù„: 203"></div>
      <div><label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±</label><input id="tName" placeholder="Ù…Ø«Ø§Ù„: Ø¹Ù„ÙŠ Ø§Ù„Ø³Ø¹Ø¯ÙŠ"></div>
      <div><label>Ø§Ù„Ø¥ÙŠØ¬Ø§Ø± Ø§Ù„Ø´Ù‡Ø±ÙŠ (Ø±.Ø¹)</label><input id="tRent" type="number" step="0.001" placeholder="Ù…Ø«Ø§Ù„: 180"></div>
      <div><label>Ø§Ù„Ù‡Ø§ØªÙ</label><input id="tPhone" type="tel" placeholder="9xxxxxxx"></div>
      <div><label>Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©</label><input id="tNatId" inputmode="numeric" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©"></div>
      <div><label>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„</label><input id="tStart" type="date" value="${todayIso()}"></div>
      <div><label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</label><input id="tEnd" type="date" value="${todayIso()}"></div>
      <div style="grid-column:1/-1"><label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label><textarea id="tNotes" rows="3" placeholder="ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©"></textarea></div>
    
<div class="row cols-2" style="margin-top:8px">
  <div><label>ØªØ§Ø±ÙŠØ® Ø¯ÙØ¹ Ø§Ù„Ø£Ø¬Ø§Ø±</label>
    <select id="tPayTiming"><option value="advance">Ù…Ù‚Ø¯Ù…</option><option value="arrears">Ù…Ø¤Ø®Ø±</option></select>
  </div>
</div>
</div>
    <div class="row" style="grid-template-columns:1fr auto"><div></div>
      <button type="button" class="btn primary" id="saveT">Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±</button>
    </div>`);
  document.getElementById('saveT').onclick = async ()=>{ if(!activeBuildingId) return alert('Ø§Ø®ØªØ± Ù…Ø¨Ù†Ù‰ Ø£ÙˆÙ„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø´Ø¨ÙƒØ©');
    const data={ kind:$('#tKind').value, unitNumber:($('#tUnit').value||'').trim(), tenantName:($('#tName').value||'').trim(), rent:Number(($('#tRent').value||0)), phone:($('#tPhone').value||'').trim(), nationalId:($('#tNatId').value||'').trim(), startDate:$('#tStart').value, endDate:$('#tEnd').value, notes:($('#tNotes').value||'').trim() };
    if(!data.unitNumber || !data.tenantName) return alert('Ø£ÙƒÙ…Ù„ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
    await addTenantFS(activeBuildingId, data); closeModal(); renderBuilding();
  };
}
window.openAddTenantModal = openAddTenantModal;

// ===================== Expenses =====================
function numberFromInputLocal(v){ if(!v) return NaN; v=String(v).replace(/[Ù -Ù©]/g,ch=>'Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©'.indexOf(ch)).replace(/,/g,'.').replace(/[^\d.]/g,''); return Number(v); }
async function openExpensesModal(){ 
  if(!activeBuildingId) return alert('Ø§ÙØªØ­ Ù…Ø¨Ù†Ù‰ Ø£ÙˆÙ„Ø§Ù‹');
  const bRef = await db.collection('buildings').doc(activeBuildingId).get(); const b={id:bRef.id, ...bRef.data()};
  openModal(`Ù…ØµØ±ÙˆÙØ§Øª â€” ${b.name}`, `
    <div class="row cols-3">
      <div id="typeList"><label>Ù†ÙˆØ¹ Ø§Ù„Ù…ØµØ±ÙˆÙ</label>
        <select id="exType" onchange="if(this.value==='Ø£Ø®Ø±Ù‰'){document.getElementById('typeList').style.display='none';document.getElementById('typeCustom').style.display='block';document.getElementById('exTypeCustom').focus();}">
          <option value="">Ø§Ø®ØªØ±</option>
          <option>ÙƒÙ‡Ø±Ø¨Ø§Ø¡</option><option>Ù…Ø§Ø¡</option><option>Ø±ÙˆØ§ØªØ¨</option><option>ØªÙ†Ø¸ÙŠÙ</option><option>Ø§Ù†ØªØ±Ù†Øª</option><option>ØµÙŠØ§Ù†Ø©</option><option>Ø£Ø®Ø±Ù‰</option>
        </select>
      </div>
      <div id="typeCustom" style="display:none"><label>Ù†ÙˆØ¹ Ø§Ù„Ù…ØµØ±ÙˆÙ</label>
        <div style="display:flex;gap:8px"><input id="exTypeCustom" placeholder="Ø§ÙƒØªØ¨ Ù†ÙˆØ¹Ù‹Ø§"> <button type="button" class="btn" onclick="document.getElementById('typeCustom').style.display='none';document.getElementById('typeList').style.display='block';">Ø±Ø¬ÙˆØ¹</button></div>
      </div>
      <div><label>Ø§Ù„Ù…Ø¨Ù„Øº (Ø±.Ø¹)</label><input id="exAmount" inputmode="decimal" placeholder="Ù…Ø«Ø§Ù„: 20"></div>
      <div><label>Ø§Ù„ØªØ§Ø±ÙŠØ®</label><input id="exDate" type="date" value="${selYear}-${String(selMonth).padStart(2,'0')}-01"></div>
      <div style="grid-column:1/-1"><label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label><textarea id="exNotes" rows="2" placeholder="ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©"></textarea></div>
    </div>
    <div id="exError" class="muted" style="color:#b91c1c;margin-top:4px"></div>
    <div class="row" style="grid-template-columns:1fr auto auto">
      <div></div>
      <button type="button" class="btn primary" id="exSave">Ø­ÙØ¸</button>
      <button type="button" class="btn danger" id="exClear">ØªÙØ±ÙŠØº</button>
    </div>
    <div style="height:1px;background:#e5e7eb;margin:12px 0"></div>
    <div style="overflow:auto">
      <table>
        <thead><tr><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„Ù…Ø¨Ù„Øº (Ø±.Ø¹)</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr></thead>
        <tbody id="expensesTbody"></tbody>
        <tfoot><tr><td style="text-align:left">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:</td><td id="expensesTotalCell" style="font-weight:700"></td><td colspan="3"></td></tr></tfoot>
      </table>
    </div>`);
  document.getElementById('exClear').onclick = ()=>{ ['exType','exTypeCustom','exAmount','exNotes'].forEach(id=>{const el=document.getElementById(id); if(el) el.value='';}); const d=document.getElementById('exDate'); if(d) d.value=`${selYear}-${String(selMonth).padStart(2,'0')}-01`; document.getElementById('exError').textContent=''; };
  document.getElementById('exSave').onclick = async ()=>{ 
    let type=''; const custom=document.getElementById('typeCustom');
    if(custom && custom.style.display==='block') type = (document.getElementById('exTypeCustom')?.value||'').trim(); else { type = (document.getElementById('exType')?.value||'').trim(); if(type==='Ø£Ø®Ø±Ù‰') type=''; }
    const amount = numberFromInputLocal(document.getElementById('exAmount')?.value); const date = (document.getElementById('exDate')?.value)||`${selYear}-${String(selMonth).padStart(2,'0')}-01`; const notes = (document.getElementById('exNotes')?.value)||'';
    if(!type || !isFinite(amount) || amount<=0) return document.getElementById('exError').textContent='Ø£ÙƒÙ…Ù„ Ù†ÙˆØ¹ Ø§Ù„Ù…ØµØ±ÙˆÙ ÙˆØ§Ù„Ù…Ø¨Ù„Øº';
    const y = Number(date.slice(0,4)); const m = Number(date.slice(5,7)); const period = `${y}-${String(m).padStart(2,'0')}`;
    await addExpenseFS(activeBuildingId, {type, amount, date, notes, year:y, month:m, period});
    document.getElementById('exError').textContent='ØªÙ… Ø§Ù„Ø­ÙØ¸ âœ“'; document.getElementById('exDate').value = `${selYear}-${String(selMonth).padStart(2,'0')}-01`; renderExpensesTable();
  };
  await renderExpensesTable();
}
window.openExpensesModal = openExpensesModal;

async function renderExpensesTable(){ 
  const rowsAll = await listExpenses(activeBuildingId); const tbody=document.getElementById('expensesTbody'); const totalCell=document.getElementById('expensesTotalCell'); if(!tbody) return;
  const ms = startOfMonth(selYear, selMonth), me=endOfMonth(selYear, selMonth);
  const rows = rowsAll.filter(r=> isActiveDuring(r.date,r.date, ms, me) );
  if(rows.length===0){ tbody.innerHTML=`<tr><td colspan="5" style="text-align:center;color:#6b7280;padding:10px">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ØµØ±ÙˆÙØ§Øª ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±.</td></tr>`; if(totalCell) totalCell.textContent='0.00 Ø±.Ø¹'; return; }
  tbody.innerHTML = rows.map(r=>`<tr><td>${r.type}</td><td>${Number(r.amount).toFixed(2)}</td><td>${fmtDate(r.date)}</td><td>${r.notes||''}</td><td style="white-space:nowrap"><button type="button" class="btn" onclick="editExpenseRow('${r.id}')">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button> <button type="button" class="btn danger" onclick="deleteExpenseRow('${r.id}')">ğŸ—‘ï¸ Ø­Ø°Ù</button></td></tr>`).join('');
  const total = rows.reduce((s,r)=>s+Number(r.amount||0),0); if(totalCell) totalCell.textContent = total.toFixed(2)+' Ø±.Ø¹';
}

// ===================== Report =====================
async function renderReport_legacy(){ 
  const bRef = await db.collection('buildings').doc(activeBuildingId).get(); const b={id:bRef.id, ...bRef.data()};
  const tenantsAll = await listTenants(b.id); const expensesAll = await listExpenses(b.id);
  const yyyy = selYear; const mm = String(selMonth).padStart(2,'0'); const ms = startOfMonth(selYear, selMonth), me=endOfMonth(selYear, selMonth);
  const tenants = tenantsAll.filter(t=> isActiveDuring(t.startDate,t.endDate, ms, me) );
  const apartments = tenants.filter(t=>t.kind==='apartment');
  const shops = tenants.filter(t=>t.kind==='shop' || t.kind==='showroom');
  const expenses = expensesAll.filter(e=> isActiveDuring(e.date,e.date, ms, me) );
  const payload = {
    buildingName: b.name || '',
    location: b.location || '',
    contact: b.contact || '',
    owner: b.owner || '',
    year: yyyy,
    month: mm,
    header: { location: b.location || '', contact: b.contact || '' },
    apartments: apartments.map(t=>({unitNumber:t.unitNumber||'', tenantName:t.tenantName||'', rent:+(t.rent||0), startDate:t.startDate, endDate:t.endDate, phone:t.phone||'', nationalId:t.nationalId||'', notes:t.notes||''})),
    shops: shops.map(t=>({unitNumber:t.unitNumber||'', tenantName:t.tenantName||'', rent:+(t.rent||0), startDate:t.startDate, endDate:t.endDate, phone:t.phone||'', nationalId:t.nationalId||'', notes:t.notes||''})),
    expenses: expenses.map(e=>({type:e.type||'', amount:+(e.amount||0), date:e.date||'', notes:e.notes||''}))
  };

  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{ localStorage.setItem('pm_report_payload', JSON.stringify(payload)); }catch(e){ console.warn('localStorage error', e); }
  const reportURL = new URL('property_report_pdffix.html', location.href).href;

  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
    const html = await fetch(reportURL).then(r=>r.text());
    const w = window.open('', '_blank');
    w.document.open(); w.document.write(html); w.document.close();
  }catch(e){
    window.open(reportURL, '_blank');
  }
}

// ===================== CSV Importer =====================
function toEN(numStr){ if(!numStr) return ''; return String(numStr).replace(/[Ù -Ù©]/g, d=>'Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©'.indexOf(d)); }
function parseDateFlex(s){
  if(!s) return '';
  s = s.trim();
  if(/^\d{4}-\d{2}-\d{2}$/.test(s)) return s;
  const m = toEN(s).match(/^(\d{1,2})[\/\-\.](\d{1,2})[\/\-\.](\d{4})$/);
  if(m){ const d=String(m[1]).padStart(2,'0'); const mo=String(m[2]).padStart(2,'0'); const y=m[3]; return `${y}-${mo}-${d}`; }
  return s;
}
function csvParseLine(raw){
  const out=[]; let cur='', q=false;
  for(let i=0;i<raw.length;i++){ const ch=raw[i];
    if(ch==='"'){ if(raw[i+1]=='"'){ cur+='"'; i++; } else { q=!q; } continue; }
    if(ch===',' && !q){ out.push(cur); cur=''; continue; }
    cur+=ch;
  }
  out.push(cur); return out;
}
function headerMap(cols){
  const map = {};
  const norm = (s)=> (s||'').trim().toLowerCase();
  cols.forEach((c,i)=>{
    const n=norm(c);
    if(['unitnumber','unit','Ø±Ù‚Ù…','Ø±Ù‚Ù… Ø§Ù„ÙˆØ­Ø¯Ø©'].includes(n)) map.unitNumber=i;
    else if(['tenantname','name','Ø§Ù„Ø§Ø³Ù…','Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±'].includes(n)) map.tenantName=i;
    else if(['rent','rentamount','Ø§Ù„Ø¥ÙŠØ¬Ø§Ø±','Ø§Ù„Ø§ÙŠØ¬Ø§Ø±','Ø§Ù„Ù…Ø¨Ù„Øº'].includes(n)) map.rent=i;
    else if(['startdate','start','ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©','ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„'].includes(n)) map.startDate=i;
    else if(['enddate','end','ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡'].includes(n)) map.endDate=i;
    else if(['phone','phonenumber','Ø§Ù„Ù‡Ø§ØªÙ','Ø§Ù„Ø¬ÙˆØ§Ù„','Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ'].includes(n)) map.phone=i;
    else if(['note','notes','Ù…Ù„Ø§Ø­Ø¸Ø©','Ù…Ù„Ø§Ø­Ø¸Ø§Øª'].includes(n)) map.notes=i;
    else if(['kind','type','Ù†ÙˆØ¹'].includes(n)) map.kind=i;
    else if(['nationalid','id','civilid','Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©','Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©'].includes(n)) map.nationalId=i; // Ø§Ø®ØªÙŠØ§Ø±ÙŠ
  });
  return map;
}
async function openImportCSV(){
  if(!activeBuildingId){ alert('Ø§Ø®ØªØ± Ù…Ø¨Ù†Ù‰ Ø£ÙˆÙ„Ø§Ù‹'); return; }
  openModal('Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ø³ØªØ£Ø¬Ø±ÙŠÙ† (CSV)', `
    <div class="row">
      <input type="file" id="csvFile" accept=".csv,text/csv">
      <div id="csvWarn" class="muted" style="margin-top:6px"></div>
      <div style="max-height:40vh;overflow:auto;border:1px solid var(--border);border-radius:8px;margin-top:8px">
        <table id="csvPreview"><thead></thead><tbody></tbody></table>
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px">
        <button class="btn" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
        <button class="btn primary" id="csvImportBtn" disabled>Ø§Ø³ØªÙŠØ±Ø§Ø¯</button>
      </div>
    </div>`);
  const fileInput = document.getElementById('csvFile');
  const warn = document.getElementById('csvWarn');
  const btn = document.getElementById('csvImportBtn');
  const th = document.querySelector('#csvPreview thead');
  const tb = document.querySelector('#csvPreview tbody');
  let parsedRows = [];

  fileInput.onchange = ()=>{
    const f=fileInput.files&&fileInput.files[0]; if(!f) return;
    const fr=new FileReader();
    fr.onload=()=>{
    
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
        const lines=String(fr.result).split(/\r?\n/).filter(l=>l.trim().length);
        if(lines.length<2){ warn.textContent='Ø§Ù„Ù…Ù„Ù ÙØ§Ø±Øº.'; return; }
        const cols=csvParseLine(lines[0]);
        const map=headerMap(cols);
        const need=['unitNumber','tenantName','rent','startDate','endDate','phone'];
        const missing = need.filter(k=> !(k in map));
        if(missing.length){
          warn.textContent='Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù†Ø§Ù‚ØµØ©: '+missing.join(', ');
          btn.disabled=true;
        }else{
          warn.textContent='ØªÙ… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© âœ“'+(map.nationalId!=null?' (Ø³ÙŠØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¥Ù† ÙˆÙØ¬Ø¯)':'');
          btn.disabled=false;
        }
        th.innerHTML = '<tr>'+cols.map(c=>`<th>${c}</th>`).join('')+'</tr>';
        tb.innerHTML='';
        parsedRows=[];
        for(let i=1;i<lines.length;i++){
          const row=csvParseLine(lines[i]);
          if(row.every(c=>!c.trim())) continue;
          const unit = row[map.unitNumber]||'';
          const name = row[map.tenantName]||'';
          const rent = Number(toEN(row[map.rent]||'0'));
          const start = parseDateFlex(row[map.startDate]||'');
          const end   = parseDateFlex(row[map.endDate]||'');
          const phone = toEN(row[map.phone]||'').trim();
          const notes = (map.notes!=null? row[map.notes] : '') || '';
          let kind = (map.kind!=null? (row[map.kind]||'') : '');
          const nationalId = map.nationalId!=null ? toEN(row[map.nationalId]||'').trim() : '';
          kind = String(kind).trim().toLowerCase();
          if(/(Ø´Ù‚Ø©|apartment)/.test(kind)) kind='apartment';
          else if(/(Ù…Ø­Ù„|shop)/.test(kind)) kind='shop';
          else if(/(Ù…Ø¹Ø±Ø¶|showroom)/.test(kind)) kind='showroom';
          else if(/(Ù‚Ø¨Ùˆ|basement)/.test(kind)) kind='basement';
          else kind='apartment';
          parsedRows.push({unitNumber:unit, tenantName:name, rent, startDate:start, endDate:end, phone, nationalId, notes, kind});
          tb.innerHTML += '<tr>'+row.map(c=>`<td>${c}</td>`).join('')+'</tr>';
        }
      }catch(e){ console.error(e); warn.textContent='ØªØ¹Ø°Ø± Ù‚Ø±Ø§Ø¡Ø© CSV'; }
    };
    fr.readAsText(f,'utf-8');
  };

  btn.onclick = async ()=>{
    if(!parsedRows.length) return;
    let added=0, failed=0;
    for(const r of parsedRows){
    
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{ await addTenantFS(activeBuildingId, r); added++; }catch(e){ failed++; }
    }
    alert(`ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯: ${added} â€¢ ÙØ´Ù„: ${failed}`);
    closeModal(); renderBuilding();
  };
}
window.openImportCSV = openImportCSV;

// ===================== Modal helpers =====================
function openModal(title, html){
  document.getElementById('modalTitle').textContent=title;
  document.getElementById('modalBody').innerHTML=html;
  document.getElementById('modalWrap').classList.add('show');
  document.getElementById('modalWrap').setAttribute('aria-hidden','false');
}
function closeModal(){
  document.getElementById('modalWrap').classList.remove('show');
  document.getElementById('modalWrap').setAttribute('aria-hidden','true');
  document.getElementById('modalBody').innerHTML='';
}

// ===================== Boot =====================
populateYM();
renderDashboard();

</script>

<!-- Report Modal (Injected) -->
<style>
  .modal-wrap{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:9999}
  .modal-wrap.show{display:flex}
  .modal-wrap .backdrop{position:absolute;inset:0;background:rgba(0,0,0,.35)}
  .modal-wrap .modal{position:relative;background:#fff;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.2);width:min(900px,94vw);max-height:90vh;overflow:auto}
  .modal .head{display:flex;justify-content:space-between;align-items:center;padding:12px 14px;border-bottom:1px solid #e5e7eb}
  .modal .body{padding:16px}
  .modal .btn{padding:8px 10px;border-radius:8px;border:1px solid #e5e7eb;background:#f9fafb;cursor:pointer}
  .modal .btn.icon{width:36px;height:36px;display:inline-flex;align-items:center;justify-content:center}
  .report-header{padding:12px;margin:10px 0;border:1px solid #e5e7eb;border-radius:12px;background:#fff}
  .report-header .row{display:flex;gap:16px;flex-wrap:wrap}
  .section{margin:18px 0}
  table.zebra{width:100%;border-collapse:collapse;font-size:14px}
  table.zebra th,table.zebra td{border:1px solid #e5e7eb;padding:8px;vertical-align:top}
  table.zebra thead th{background:#f5f7fb}
  table.zebra .c{text-align:center}
  table.zebra .sum{font-weight:600}
  @media print{
    .modal .head{display:none}
    .modal{box-shadow:none;border:none}
    .modal-wrap{position:static;display:block}
    .modal .body{padding:0}
  }
</style>

<div id="reportModal" class="modal-wrap" aria-hidden="true">
  <div class="backdrop" onclick="closeReport()"></div>
  <div class="modal" role="dialog" aria-modal="true">
    <div class="head">
      <h3 style="margin:0">Ø§Ù„ØªÙ‚Ø±ÙŠØ±</h3>
      <div style="display:flex;gap:8px">
        <button type="button" class="btn" onclick="exportReportPDF()">ØªØµØ¯ÙŠØ± PDF</button>
        <button type="button" class="btn" onclick="closeReport()">âœ•</button>
      </div>
    </div>
    <div class="body">
      <div id="reportRoot">
        <div class="report-header">
          <div class="row">
            <div><b>Ø§Ø³Ù… Ø§Ù„Ù…Ø¨Ù†Ù‰:</b> <span id="r_name">â€”</span></div>
            <div><b>Ø§Ù„Ø³Ù†Ø©:</b> <span id="r_year">â€”</span></div>
            <div><b>Ø§Ù„Ø´Ù‡Ø±:</b> <span id="r_month">â€”</span></div>
            <div><b>Ø§Ù„Ù…ÙˆÙ‚Ø¹:</b> <span id="r_loc">â€”</span></div>
            <div><b>Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„:</b> <span id="r_phone">â€”</span></div>
          </div>
        </div>
        <div id="r_content"></div>
      </div>
    </div>
  </div>
</div>
<!-- End Report Modal (Injected) -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

<script>
(function(){
  function openReport(){ var m=document.getElementById('reportModal'); if(m){ m.classList.add('show'); m.style.display='flex'; } }
  function closeReport(){ var m=document.getElementById('reportModal'); if(m){ m.classList.remove('show'); m.style.display='none'; } }
  window.openReport = openReport;
  window.closeReport = closeReport;

  window.exportReportPDF = function(){
    var root = document.getElementById('reportRoot');
    if(!root || !window.html2pdf){ return; }
    var opt = {
      margin: 10,
      filename: 'report.pdf',
      image: { type:'jpeg', quality:0.98 },
      html2canvas: { scale: 2.0, backgroundColor:'#ffffff', letterRendering:true, scrollY: 0 },
      jsPDF: { unit:'mm', format:'a4', orientation:'portrait' }
    };
    window.html2pdf().set(opt).from(root).save();
  };

  // Helper format date safely
  function fmt(d){
  
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
      if(!d) return '';
      var dt = new Date(d);
      if(!isNaN(dt.getTime())) return dt.toISOString().slice(0,10);
      // if it's already yyyy-mm-dd
      if(typeof d === 'string' && /^\d{4}-\d{2}-\d{2}/.test(d)) return d.slice(0,10);
      return String(d);
    }catch(e){ return String(d||''); }
  }

  // Expose a safe replace for renderReport; if existed, we override.
  window.renderReport = async function(){
  
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
      function numLike(v){ try{ if(v==null) return Number.POSITIVE_INFINITY; var m = String(v).match(/\d+/); return m? parseInt(m[0],10) : Number.POSITIVE_INFINITY; }catch(e){ return Number.POSITIVE_INFINITY; } }
// Expect globals: db, activeBuildingId, selYear, selMonth, startOfMonth, endOfMonth, listTenants, listExpenses
      if(typeof db === 'undefined'){ alert('Database not initialized'); return; }
      if(typeof activeBuildingId === 'undefined' || !activeBuildingId){ alert('Ø§Ø®ØªØ± Ù…Ø¨Ù†Ù‰ Ø£ÙˆÙ„Ø§Ù‹'); return; }

      var bRef = await db.collection('buildings').doc(activeBuildingId).get();
      var b = Object.assign({id:bRef.id}, bRef.data()||{});

      var tenantsAll = (typeof listTenants === 'function') ? await listTenants(b.id) : [];
      var expensesAll = (typeof listExpenses === 'function') ? await listExpenses(b.id) : [];

      var yyyy = (typeof selYear !== 'undefined') ? selYear : new Date().getFullYear();
      var monthIndex = (typeof selMonth !== 'undefined') ? selMonth : (new Date().getMonth()+1);
      var mm = String(monthIndex).padStart(2,'0');

      var ms = (typeof startOfMonth==='function') ? startOfMonth(yyyy, monthIndex) : new Date(yyyy, monthIndex-1, 1).toISOString();
      var me = (typeof endOfMonth==='function') ? endOfMonth(yyyy, monthIndex) : new Date(yyyy, monthIndex, 0).toISOString();

      function activeDuring(s,e,from,to){
        var sd = new Date(s||from).getTime();
        var ed = new Date(e||to).getTime();
        var fd = new Date(from).getTime();
        var td = new Date(to).getTime();
        return !(ed < fd || sd > td);
      }

      var tenants = tenantsAll.filter(function(t){ return activeDuring(t.startDate, t.endDate, ms, me); });
      var apartments = tenants.filter(function(t){ return t.kind==='apartment'; });
      apartments.sort(function(a,b){return numLike(a.unitNumber)-numLike(b.unitNumber);});
      var shops = tenants.filter(function(t){ return (t.kind==='shop' || t.kind==='showroom'); });
      shops.sort(function(a,b){return numLike(a.unitNumber)-numLike(b.unitNumber);});
      var expenses = expensesAll.filter(function(e){ return activeDuring(e.date, e.date, ms, me); });

      var payload = {
        buildingName: b.name||'',
        header: { location: b.location||'', contact: b.contact||'' },
        year: yyyy, month: mm,
        apartments: apartments.map(function(t){ return {unitNumber:t.unitNumber||'', tenantName:t.tenantName||'', rent:+(t.rent||0), startDate:t.startDate, endDate:t.endDate, phone:t.phone||'', notes:t.notes||''}; }),
        shops: shops.map(function(t){ return {unitNumber:t.unitNumber||'', tenantName:t.tenantName||'', rent:+(t.rent||0), startDate:t.startDate, endDate:t.endDate, phone:t.phone||'', notes:t.notes||''}; }),
        expenses: expenses.map(function(e){ return {type:e.type||'', amount:+(e.amount||0), date:e.date||'', notes:e.notes||''}; })
      };

      // Fill header
      var setText = function(id, v){ var el = document.getElementById(id); if(el) el.textContent = v; };
      setText('r_name',  payload.buildingName || 'â€”');
      setText('r_year',  String(payload.year));
      setText('r_month', String(payload.month).padStart(2,'0'));
      setText('r_loc',   payload.header.location || 'â€”');
      setText('r_phone', payload.header.contact || 'â€”');

      // Totals
      var totalApt = payload.apartments.reduce(function(s,t){return s + Number(t.rent||0)},0);
      var totalShop = payload.shops.reduce(function(s,t){return s + Number(t.rent||0)},0);
      var billsTotal = payload.expenses.reduce(function(s,e){return s + Number(e.amount||0)},0);
      var grand = totalApt + totalShop;
      var mgmt = 0; var feeType = (b.feeType||'percentage'); var feeValue = Number(b.feeValue||0);
      if(feeType==='salary'){ mgmt = +feeValue; } else { mgmt = +(grand * (feeValue/100)).toFixed(2); }
      var afterAll = +(grand - mgmt - billsTotal).toFixed(2);

      function rowTenant(t,i){
        return '<tr>'
          + '<td class="c">'+(i+1)+'</td>'
          + '<td class="c">'+(t.unitNumber||'')+'</td>'
          + '<td>'+(t.tenantName||'')+'</td>'
          + '<td class="c">'+Number(t.rent||0).toFixed(2)+'</td>'
          + '<td class="c">'+fmt(t.startDate)+'</td>'
          + '<td class="c">'+fmt(t.endDate)+'</td>'
          + '<td class="c">'+(t.phone||'')+'</td>'
          + '<td>'+(t.notes||'')+'</td>'
        + '</tr>';
      }

      var r = document.getElementById('r_content');
      if(!r){ alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø­Ø§ÙˆÙŠØ© Ø§Ù„ØªÙ‚Ø±ÙŠØ±'); return; }
      r.innerHTML = ''
        + '<div class="section">'
        + '  <h3>Ø§Ù„Ø´Ù‚Ù‚</h3>'
        + '  <table class="zebra">'
        + '    <thead><tr><th>#</th><th>Ø´Ù‚Ø© Ø±Ù‚Ù…</th><th>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±</th><th>Ø§Ù„Ø¥ÙŠØ¬Ø§Ø±</th><th>Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¹Ù‚Ø¯</th><th>Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¹Ù‚Ø¯</th><th>Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„</th><th>Ù…Ù„Ø§Ø­Ø¸Ø©</th></tr></thead>'
        + '    <tbody>'+(payload.apartments.length ? payload.apartments.map(rowTenant).join('') : '<tr><td class="c" colspan="8">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</td></tr>')+'</tbody>'
        + '    <tfoot><tr><td colspan="3" class="c">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</td><td class="c sum">'+totalApt.toFixed(2)+'</td><td colspan="4"></td></tr></tfoot>'
        + '  </table>'
        + '</div>'

        + '<div class="section">'
        + '  <h3>Ø§Ù„Ù…Ø­Ù„Ø§Øª / Ø§Ù„Ù…Ø¹Ø§Ø±Ø¶</h3>'
        + '  <table class="zebra">'
        + '    <thead><tr><th>#</th><th>Ø±Ù‚Ù… Ø§Ù„Ù…Ø­Ù„/Ø§Ù„Ù…Ø¹Ø±Ø¶</th><th>Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±</th><th>Ø§Ù„Ø¥ÙŠØ¬Ø§Ø±</th><th>Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¹Ù‚Ø¯</th><th>Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¹Ù‚Ø¯</th><th>Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„</th><th>Ù…Ù„Ø§Ø­Ø¸Ø©</th></tr></thead>'
        + '    <tbody>'+(payload.shops.length ? payload.shops.map(rowTenant).join('') : '<tr><td class="c" colspan="8">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</td></tr>')+'</tbody>'
        + '    <tfoot><tr><td colspan="3" class="c">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</td><td class="c sum">'+totalShop.toFixed(2)+'</td><td colspan="4"></td></tr></tfoot>'
        + '  </table>'
        + '</div>'

        + '<div class="section">'
        + '  <h3>Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</h3>'
        + '  <table class="zebra">'
        + '    <thead><tr><th>Ø§Ù„Ø®Ø¯Ù…Ø©</th><th>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®Ø¯Ù…Ø©</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th></tr></thead>'
        + '    <tbody>' + (payload.expenses.length ? payload.expenses.map(function(e, i){ return `<tr><td>${e.type||''}</td><td class="c">${Number(e.amount||0).toFixed(2)}</td><td class="c">${fmt(e.date)}</td><td>${e.notes||''}</td><td class="c" style="white-space:nowrap"><button type="button" class="btn" onclick="editExpense(${i})">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button> <button type="button" class="btn danger" onclick="deleteExpense(${i})">ğŸ—‘ï¸ Ø­Ø°Ù</button></td></tr>`; }).join('') : '<tr><td class="c" colspan="5">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ØµØ±ÙˆÙØ§Øª</td></tr>')+'</tbody>'
        + '    <tfoot><tr><td style="text-align:left">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</td><td class="c sum">'+billsTotal.toFixed(2)+'</td><td colspan="2"></td></tr></tfoot>'
        + '  </table>'
        + '</div>'

        + '<div class="section">'
        + '  <h3>Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</h3>'
        + '  <table class="zebra">'
        + '    <tbody>'
        + '      <tr><td>Ù…Ø¬Ù…ÙˆØ¹ Ø¥ÙŠØ¬Ø§Ø± Ø§Ù„Ø´Ù‚Ù‚</td><td class="c">'+totalApt.toFixed(2)+'</td></tr>'
        + '      <tr><td>Ù…Ø¬Ù…ÙˆØ¹ Ø¥ÙŠØ¬Ø§Ø± Ø§Ù„Ù…Ø­Ù„Ø§Øª</td><td class="c">'+totalShop.toFixed(2)+'</td></tr>'
        + '      <tr><td>Ø§Ù„Ø¥ÙŠØ¬Ø§Ø± Ø§Ù„ÙƒÙ„ÙŠ</td><td class="c">'+grand.toFixed(2)+'</td></tr>'
        + '      ' + ( (b.feeType||'percentage')==='salary' ? "<tr><td>Ø±Ø§ØªØ¨ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</td><td class=\"c\">"+mgmt.toFixed(2)+"</td></tr>" : ("<tr><td>Ù†Ø³Ø¨Ø© Ø±Ø³ÙˆÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© "+Number(b.feeValue||0)+"%</td><td class=\"c\">"+mgmt.toFixed(2)+"</td></tr>") ) + ''
        + '      <tr><td>Ø§Ù„ÙÙˆØ§ØªÙŠØ±</td><td class="c">'+billsTotal.toFixed(2)+'</td></tr>'
        + '      <tr><td><b>Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¥ÙŠØ¬Ø§Ø± Ø¨Ø¹Ø¯ Ø®ØµÙ… Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ùˆ Ø±Ø³ÙˆÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</b></td><td class="c sum">'+afterAll.toFixed(2)+'</td></tr>'
        + '    </tbody>'
        + '  </table>'
        + '</div>';

      openReport();
    }catch(err){
      console.error(err);
      alert('ØªØ¹Ø°Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙØ­Ø©.');
    }
  };
})();
</script>


<script>
(function(){
  var _origAdd = window.addTenantFS;
  var _origUpd = window.updateTenantFS;

  async function hasDuplicate(bid, kind, unitNumber, excludeId){
  
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
      if(!window.listTenants) return false;
      var all = await window.listTenants(bid);
      unitNumber = (unitNumber||'').toString().trim();
      kind = (kind||'').toString().trim();
      return all.some(function(t){
        if(excludeId && t.id===excludeId) return false;
        var u = (t.unitNumber||'').toString().trim();
        var k = (t.kind||'').toString().trim();
        return u && k && u===unitNumber && k===kind;
      });
    }catch(e){ return false; }
  }

  if(typeof _origAdd === 'function'){
    window.addTenantFS = async function(bid, data){
      var dup = await hasDuplicate(bid, data && data.kind, data && data.unitNumber, null);
      if(dup){
        alert('Ø±Ù‚Ù… Ø§Ù„ÙˆØ­Ø¯Ø© Ù…Ø³Ø¬Ù‘Ù„ Ù…Ø³Ø¨Ù‚Ù‹Ø§ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù†ÙˆØ¹ ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù…Ø¨Ù†Ù‰. Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªÙƒØ±Ø§Ø±.');
        throw new Error('duplicate-unit');
      }
      return _origAdd(bid, data);
    };
  }

  if(typeof _origUpd === 'function'){
    window.updateTenantFS = async function(bid, id, patch){
    
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
        var kind = patch && patch.kind;
        var unitNumber = patch && patch.unitNumber;
        if((!kind || !unitNumber) && window.listTenants){
          var all = await window.listTenants(bid);
          var cur = all.find(function(t){return t.id===id;});
          kind = kind || (cur && cur.kind);
          unitNumber = unitNumber || (cur && cur.unitNumber);
        }
        var dup = await hasDuplicate(bid, kind, unitNumber, id);
        if(dup){
          alert('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„: Ù‡Ø°Ù‡ Ø§Ù„ÙˆØ­Ø¯Ø© Ù…ÙˆØ¬ÙˆØ¯Ø© Ø¨Ø§Ù„ÙØ¹Ù„.');
          throw new Error('duplicate-unit');
        }
      }catch(e){ if(e && e.message==='duplicate-unit') throw e; }
      return _origUpd(bid, id, patch);
    };
  }
})();
</script>


<script>
(function(){
  window.__unitPriority = function(kind){
    // Arabic mapping: Ø´Ù‚Ø©=apartment, Ù…Ø­Ù„=shop, Ù…Ø¹Ø±Ø¶=showroom, Ø§Ù„Ù‚Ø¨Ùˆ=basement (we store in English kinds)
    switch((kind||'').toLowerCase()){
      case 'apartment': return 1;
      case 'shop': return 2;
      case 'showroom': return 3;
      case 'basement': return 4;
      default: return 99;
    }
  };
  window.__numLike = function(v){
    if(v==null) return Number.POSITIVE_INFINITY;
    var m = String(v).match(/\d+/);
    return m ? parseInt(m[0],10) : Number.POSITIVE_INFINITY;
  };
  window.sortUnitsByKindAndNumber = function(arr){
  
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
      return (arr||[]).slice().sort(function(a,b){
        var pa = __unitPriority(a && a.kind);
        var pb = __unitPriority(b && b.kind);
        if(pa!==pb) return pa - pb;
        // same kind -> by unit number ascending
        var na = __numLike(a && a.unitNumber);
        var nb = __numLike(b && b.unitNumber);
        if(na!==nb) return na - nb;
        // fallback: by tenant name to stabilize
        var ta = (a && a.tenantName || '').toString();
        var tb = (b && b.tenantName || '').toString();
        return ta.localeCompare(tb, 'ar');
      });
    }catch(e){ return arr||[]; }
  };
})();
</script>


<script>
(function(){
  function isDeleteButton(btn){
    if(!btn) return false;
    var txt = (btn.textContent||'').trim();
    return /Ø­Ø°Ù/.test(txt);
  }
  document.addEventListener('click', function(e){
    var btn = e.target.closest('button');
    if(!btn) return;
    if(!btn.closest('.modal')) return; // only inside modals
    if(isDeleteButton(btn)){
      if(!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¬Ù„ØŸ')){
        e.preventDefault();
        e.stopImmediatePropagation();
        return false;
      }
    }
  }, true);
})();
</script>


<script>
(function(){
  function fixExpenseButtonsLayout(){
    document.querySelectorAll('.modal').forEach(function(m){
      var editBtn = Array.from(m.querySelectorAll('button')).find(b => (b.textContent||'').indexOf('ØªØ¹Ø¯ÙŠÙ„')!==-1);
      var delBtn  = Array.from(m.querySelectorAll('button')).find(b => (b.textContent||'').indexOf('Ø­Ø°Ù')!==-1);
      if(editBtn && delBtn){
        var parent = editBtn.parentElement;
        if(parent && parent === delBtn.parentElement){
          parent.style.display = 'flex';
          parent.style.gap = '10px';
          parent.style.flexWrap = 'wrap';
          parent.style.alignItems = 'center';
        }
      }
    });
  }
  // Patch renderBuilding to call layout fix
  if(typeof window.renderBuilding==='function' && !window.__expLayoutPatched){
    var _old = window.renderBuilding;
    window.renderBuilding = async function(){
      var r = await _old.apply(this, arguments);
    
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{ fixExpenseButtonsLayout(); }catch(e){}
      return r;
    };
    window.__expLayoutPatched = true;
  }
  window.addEventListener('load', fixExpenseButtonsLayout);
})();
</script>


<script>
(function(){
  function adjustTenantButtons(){
    var list = document.getElementById('tenantsList');
    if(!list) return;
    Array.from(list.children).forEach(function(row){
      var text = (row.textContent||'').trim();
      var actions = row.querySelector('[data-edit]') && row.querySelector('[data-del]');
      // Hide for vacant
      if(/Ø´Ø§ØºØ±/.test(text)){
        var actionsBox = row.querySelector('[data-edit]') && row.querySelector('[data-edit]').parentElement;
        if(actionsBox){ actionsBox.style.display = 'none'; }
      }else{
        // ensure visible for occupied
        var actionsBox = row.querySelector('[data-edit]') && row.querySelector('[data-edit]').parentElement;
        if(actionsBox){ actionsBox.style.display = 'flex'; actionsBox.style.gap='8px'; }
      }
    });
  }

  // Confirm delete on tenants list (Arabic message)
  document.addEventListener('click', function(e){
    var btn = e.target.closest('[data-del]');
    if(!btn) return;
    if(!btn.closest('#tenantsList')) return;
    var ok = confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±ØŸ');
    if(!ok){ e.preventDefault(); e.stopImmediatePropagation(); }
  }, true);

  // Patch renderBuilding to run adjust after rendering
  if(typeof window.renderBuilding==='function' && !window.__tenantBtnsPatched){
    var _old = window.renderBuilding;
    window.renderBuilding = async function(){
      var r = await _old.apply(this, arguments);
    
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{ adjustTenantButtons(); }catch(e){}
      return r;
    };
    window.__tenantBtnsPatched = true;
  }
  window.addEventListener('load', adjustTenantButtons);
})();
</script>


<script>
(function(){
  window.__hideVacantActions = function(){
    var list = document.getElementById('tenantsList');
    if(!list) return;
    Array.from(list.children).forEach(function(row){
      var txt = (row.textContent||'').trim();
      var bar = row.querySelector('div[style*="display:flex"][style*="gap"]');
      if(!bar) return;
      if(/Ø´Ø§ØºØ±|Ø´Ø§ØºØ±Ø©/.test(txt)){ bar.style.display='none'; } else { bar.style.display='flex'; }
    });
  };
  if(typeof window.renderLists==='function' && !window.__vacantPatch){
    var _oldRL = window.renderLists;
    window.renderLists = function(){
      var r = _oldRL.apply(this, arguments);
    
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{ window.__hideVacantActions(); }catch(e){} 
      return r;
    };
    window.__vacantPatch = true;
  }
  window.addEventListener('load', window.__hideVacantActions);
})();
</script>


<script>
// ===== injected: universal pay modal override (v2) =====
(function(){
  function ensureStyles(){
    if(document.getElementById('pay-modal-style-injected')) return;
    const css = document.createElement('style');
    css.id = 'pay-modal-style-injected';
    css.textContent = `
      .modal .buttons-row{display:flex;justify-content:flex-end;gap:8px;margin-top:12px}
      .modal .btn{border:none;border-radius:8px;padding:10px 18px;cursor:pointer;font-size:15px;transition:.2s}
      .modal .btn.primary{background:#0066cc;color:#fff}
      .modal .btn.primary:hover{background:#004c99}
      .hidden{display:none}
    `;
    document.head.appendChild(css);
  }

  function bindHandlers(){
    const saveBtn = document.getElementById('savePay');
    const receiptBtn = document.getElementById('issueReceiptBtn');
    if(!saveBtn || !receiptBtn) return;

    const prev = saveBtn.onclick;
    saveBtn.onclick = async function(ev){
      if(prev){
      
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
          const p = prev.call(this, ev);
          if(p && typeof p.then==='function') await p;
        }catch(e){ /* ignore */ }
      }else{
        const note = (document.getElementById('payNote')?.value||'').trim();
        if(!note){ alert('Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø£Ùˆ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© Ø£ÙˆÙ„Ø§Ù‹'); return; }
      }
      receiptBtn.classList.remove('hidden');
    };

    receiptBtn.onclick = function(){
      const note = (document.getElementById('payNote')?.value||'').trim();
    
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
        if(typeof openReceiptWindow==='function'){
          openReceiptWindow({ note });
        }else{
          alert('ğŸ§¾ ØªÙ… Ø¥ØµØ¯Ø§Ø± Ø¥ÙŠØµØ§Ù„' + (note? (' Ø¨Ù‚ÙŠÙ…Ø©: '+note):''));
        }
      }catch(e){ console.warn(e); alert('ØªØ¹Ø°Ø± Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø¥ÙŠØµØ§Ù„'); }
    };
  }

  function payTemplate(){
    return `
      <div class="row">
        <div style="grid-column:1/-1">
          <label>Ù…Ù„Ø§Ø­Ø¸Ø© / Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¯ÙØ¹</label>
          <textarea id="payNote" rows="3" placeholder="Ù…Ø«Ø§Ù„: 280 Ù…Ù‚Ø¯Ù‘Ù… Ø£Ùˆ 200 Ù…Ø¤Ø®Ø±"></textarea>
        </div>
      </div>
      <div class="row buttons-row">
        <button type="button" class="btn primary" id="savePay">ğŸ’¾ Ø­ÙØ¸</button>
        <button type="button" class="btn primary hidden" id="issueReceiptBtn">ğŸ§¾ Ø¥ØµØ¯Ø§Ø± Ø¥ÙŠØµØ§Ù„</button>
      </div>
    `;
  }

  function overrideOpenModal(){
    if(!window.openModal || window.__openModalOverridden) return;
    const original = window.openModal;
    window.__openModalOverridden = true;
    window.openModal = function(title, html){
    
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
        const t = (title||'').toString();
        // Match Arabic/English for 'Pay'
        if(/\bØ¯ÙØ¹\b/i.test(t) || /\bpay\b/i.test(t)){
          ensureStyles();
          html = payTemplate();
          // call original
          original.call(this, title, html);
          // defer to ensure DOM exists
          setTimeout(bindHandlers, 0);
          return;
        }
      }catch(e){ /* fallthrough */ }
      // default
      return original.apply(this, arguments);
    };
  }

  // Wait DOM and then override
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', overrideOpenModal);
  }else{
    overrideOpenModal();
  }
})();
// ===== end injected =====
</script>


<script>
// --- injected: openReceiptWindow -> printable receipt voucher (blob) ---
window.openReceiptWindow = function(payload){
  try {
    var data = payload || {}, now = new Date();
    var serial = (now.getFullYear()) + "-" + String(now.getMonth()+1).padStart(2,'0') + "-" + String(now.getDate()).padStart(2,'0') + "-" + String(Math.floor(Math.random()*900+100));
    data.date = data.date || now.toLocaleDateString('ar-OM');
    data.no = data.no || serial;
    // Build final HTML by injecting payload as window.__PAYLOAD__
    var tpl = '<!DOCTYPE html><html lang="ar" dir="rtl"><head>\n<meta charset="UTF-8"><title>Ø³Ù†Ø¯ Ù‚Ø¨Ø¶</title><meta name="viewport" content="width=device-width,initial-scale=1">\n<style>\n  body{font-family:Tahoma,Arial,sans-serif;color:#111;margin:0}\n  .controls{display:flex;gap:8px;justify-content:flex-end;padding:10px;border-bottom:1px solid #eee}\n  .btn{border:1px solid #222;background:#f7f7f7;padding:6px 10px;border-radius:8px;cursor:pointer}\n  .sheet{width:794px;margin:12px auto;border:1px solid #ddd;padding:16px;border-radius:8px}\n  header{display:flex;justify-content:space-between;gap:10px}\n  .meta{font-size:12px;line-height:1.3}\n  .logo{width:80px;height:80px;object-fit:contain;border-radius:6px}\n  .badge{border:1px solid #000;padding:4px 10px;border-radius:8px;font-weight:700;display:inline-block}\n  .row{display:flex;gap:10px;margin:8px 0}\n  .field{display:flex;align-items:center;gap:8px;font-size:14px;flex:1}\n  .label{white-space:nowrap}\n  \n  .money{display:flex;gap:12px}\n  .amount{min-width:80px;text-align:center;border:1px solid #000;padding:3px 6px}\n  footer{display:flex;justify-content:space-between;margin-top:18px}\n  .sig{display:flex;align-items:center;gap:6px}.line{min-width:220px;border-bottom:1px dashed #333;height:22px}\n  @media print{.controls{display:none}.sheet{border:none;margin:0;padding:10mm;width:auto}}\n
  /* Forced RTL + right alignment */
  html, body { direction: rtl !important; text-align: right !important; }
  header, footer, .meta, .row, .field, .label, .value, .amount { text-align: right !important; }
  /* Remove dotted filler lines */
  
  /* Keep signature line visible but lighter */
  .line { border-bottom: 1px solid #666 !important; }
  ul, li { list-style: none !important; margin: 0; padding: 0; }

  /* === Enforced RTL & Right Alignment === */
  html, body, .sheet, header, footer, .meta, .row, .field, .label, .amount, .money, p, span, div, table, td, th {
    direction: rtl !important;
    text-align: right !important;
  }
  /* Flex rows align content to the right */
  .row, header, footer, .money, .field { justify-content: flex-end !important; }
  /* Remove dotted filler lines completely */
  .dline, .line.dotted, .dotted, .dots { display: none !important; border: 0 !important; height: 0 !important; min-height: 0 !important; padding: 0 !important; }
  /* Remove list bullets globally */
  ul, li { list-style: none !important; margin: 0; padding: 0; }
  /* Keep signature baseline thin (not dotted) */
  .sig .line { border-bottom: 1px solid #666 !important; height: 18px !important; }

  html, body, .sheet, header, footer, .meta, .row, .field, .label, p, div, span, table, td, th {
    direction: rtl !important;
    text-align: right !important;
  }
  .row, header, footer, .field, .money { justify-content: flex-end !important; }
  ul, li { list-style: none !important; margin: 0; padding: 0; }
    
/* === FINAL FIX: Remove all dotted borders and align text to right === */
* {
  direction: rtl !important;
  text-align: right !important;
}
*[style*="dotted"], [style*="border-bottom"], .row, .field, .meta, .amount, .money, hr, .line {
  border: none !important;
  border-bottom: none !important;
}
ul, li { list-style: none !important; margin: 0; padding: 0; }
.row, .field { justify-content: flex-end !important; }
</style></head>\n<body><div class="controls"><button class="btn" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button></div>\n<div class="sheet"><header><div style="display:flex;gap:10px;align-items:center">\n<img id="logo" class="logo" alt="logo" onerror="this.style.display=\'none\'">\n<div class="meta"><div id="company" style="font-weight:700;font-size:18px">Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø©</div>\n<div>C.R.No: <span id="cr">1294875</span></div><div>Ø³Ù„Ø·Ù†Ø© Ø¹Ù…Ø§Ù†</div>\n<div>GSM: <span id="gsm1">90929600</span> - <span id="gsm2">91366544</span></div></div></div>\n<div><div class="badge">Ø³Ù†Ø¯ Ù‚Ø¨Ø¶</div><div style="margin-top:6px">Receipt Voucher</div>\n<div>No.: <span id="no"></span></div><div>Date: <span id="date"></span></div></div></header>\n<div class="row"><div class="field"><span class="label">Ø¥Ø³ØªÙ„Ù…Ù†Ø§ Ù…Ù† Ø§Ù„ÙØ§Ø¶Ù„/Ù€Ø©</span></div></div>\n<div class="row"><div class="field"><span class="label">Ù…Ø¨Ù„Øº ÙˆÙ‚Ø¯Ø±Ù‡ Ø±ÙŠØ§Ù„ Ø¹Ù…Ø§Ù†ÙŠ</span></div></div>\n<div class="row money"><div><span class="label">R.O</span> <span class="amount" id="amount_ro"></span></div>\n<div><span class="label">Bz.</span> <span class="amount" id="amount_bz"></span></div></div>\n<div class="row"><div class="field"><span class="label">Ù†Ù‚Ø¯Ù‹Ø§ / Ø´ÙŠÙƒ Ø±Ù‚Ù…</span></div></div>\n<div class="row"><div class="field"><span class="label">Ø¨ØªØ§Ø±ÙŠØ®</span>\n<span class="label" style="margin-inline-start:8px">Ø¹Ù„Ù‰ Ø¨Ù†Ùƒ</span></div></div>\n<div class="row"><div class="field"><span class="label">ÙˆØ°Ù„Ùƒ Ø¹Ù†</span></div></div>\n<footer><div class="sig"><span>Signature :</span><div class="line" id="signature"></div></div>\n<div class="sig"><span>Receiver\'s Sig. :</span><div class="line" id="receiver"></div></div></footer></div>\n<script>\nfunction simpleWords(n){if(!isFinite(n))return\'\';const p=String((+n).toFixed(3)).split(\'.\');const ro=parseInt(p[0],10)||0;const bz=parseInt((p[1]||\'0\').padEnd(3,\'0\').slice(0,3),10)||0;const fmt=new Intl.NumberFormat(\'ar-EG\');let s=fmt.format(ro)+\' Ø±ÙŠØ§Ù„ Ø¹ÙÙ…Ø§Ù†ÙŠ\';if(bz)s+=\' Ùˆ \'+fmt.format(bz)+\' Ø¨ÙŠØ³Ø©\';return s}\nfunction fill(d){if(d.logo)document.getElementById(\'logo\').src=d.logo;document.getElementById(\'company\').textContent=d.company||\'Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø©\';document.getElementById(\'cr\').textContent=d.cr||\'1294875\';document.getElementById(\'gsm1\').textContent=d.gsm1||\'90929600\';document.getElementById(\'gsm2\').textContent=d.gsm2||\'91366544\';document.getElementById(\'no\').textContent=d.no||\'\';document.getElementById(\'date\').textContent=d.date||new Date().toLocaleDateString(\'ar-OM\');document.getElementById(\'payer\').textContent=d.payer||\'\';const ro=Math.floor(+d.amount||0);const bz=Math.round(((+d.amount||0)-ro)*100);document.getElementById(\'amount_ro\').textContent=ro||\'\';document.getElementById(\'amount_bz\').textContent=String(bz).padStart(2,\'0\');document.getElementById(\'amount_words\').textContent=simpleWords(+d.amount||0);document.getElementById(\'method\').textContent=(d.method===\'Ø´ÙŠÙƒ\'&&d.cheque)?(\'Ø´ÙŠÙƒ Ø±Ù‚Ù…: \'+d.cheque):(d.method||\'Ù†Ù‚Ø¯Ù‹Ø§\');document.getElementById(\'dated\').textContent=d.dated||d.date||\'\';document.getElementById(\'bank\').textContent=d.bank||\'\';document.getElementById(\'for\').textContent=d.for||\'\'}\nfill(window.__PAYLOAD__||{});if((window.__PAYLOAD__||{}).print) setTimeout(()=>window.print(),400);\n</script>



<script>
// --- injected v2: robust alignment + show-after-save ---
(function(){
  function findSaveBtn(){
    // Try by id
    var btn = document.getElementById('savePay');
    if(btn) return btn;
    // Fallback: search in open modal for a button contains 'Ø­ÙØ¸'
    var modals = document.querySelectorAll('.modal, [role="dialog"], .swal2-popup');
    for (var m of modals){
      var cand = Array.from(m.querySelectorAll('button, .btn')).find(b=>String(b.textContent||'').trim().includes('Ø­ÙØ¸'));
      if(cand) return cand;
    }
    // Global search
    return Array.from(document.querySelectorAll('button, .btn')).find(b=>String(b.textContent||'').trim().includes('Ø­ÙØ¸'));
  }

  function ensureButtonsRow(save){
    // Create or find row
    var row = save && save.closest('.buttons-row');
    if(!row){
      row = document.createElement('div');
      row.className = 'buttons-row';
      var host = (save && (save.closest('.row') || save.parentElement)) || document.body;
      if(host && host.parentElement){
        host.parentElement.insertBefore(row, host.nextSibling);
      }else{
        document.body.appendChild(row);
      }
      if(save) row.appendChild(save);
    }
    // Create or move receipt button
    var btn = document.getElementById('issueReceiptBtn');
    if(!btn){
      btn = document.createElement('button');
      btn.id = 'issueReceiptBtn';
      btn.type = 'button';
      btn.className = 'btn primary btn--sm hidden';
      btn.textContent = 'ğŸ§¾ Ø¥ØµØ¯Ø§Ø± Ø¥ÙŠØµØ§Ù„';
    }else{
      btn.classList.remove('block','full','w-100');
      btn.classList.add('btn','primary','btn--sm');
    }
    row.appendChild(btn);
    // Click handler for opening receipt
    if(!btn.__bound){
      btn.__bound = true;
      btn.addEventListener('click', function(){
      
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
          var amountNote = (document.getElementById('payNote')?.value || '').trim();
          // Try to parse a number from note
          var amtMatch = amountNote.match(/\d+(?:[.,]\d+)?/);
          var amount = amtMatch ? parseFloat(amtMatch[0].replace(',','.')) : 0;
          var tenantName = window.currentTenant?.name || window.currentTenant?.tenantName || '';
          var unitLabel = (window.currentTenant?.unitNumber || window.currentTenant?.unit?.number) ? ('Ø´Ù‚Ø© ' + (window.currentTenant.unitNumber || window.currentTenant.unit.number)) : (window.currentTenant?.unit || '');
          var ym = window.selectedYearMonth || '';
          var buildingName = window.currentBuilding?.name || '';
          if(typeof openReceiptWindow === 'function'){
            openReceiptWindow({tenantName, amount, unitLabel, ym, buildingName, print:true});
          }else{
            alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¯ÙØ¹. (Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯Ø§Ù„Ø© openReceiptWindow)');
          }
        }catch(e){ console.warn(e); }
      });
    }
    return btn;
  }

  function showReceiptBtn(){
    var save = findSaveBtn();
    if(!save) return;
    var btn = ensureButtonsRow(save);
    btn.classList.remove('hidden');
  }

  // Hook to openModal if available & also use MutationObserver for safety
  var patched = false;
  function patchOpenModal(){
    if(patched) return;
    var _om = window.openModal;
    if(!_om) return;
    patched = true;
    window.openModal = function(title, html){
      var ret = _om.apply(this, arguments);
    
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
        if(/ØªØ³Ø¬ÙŠÙ„\s*Ø¯ÙØ¹/i.test(String(title)) || /pay/i.test(String(title))){
          // Wait a tick for DOM to render
          setTimeout(function(){
            var save = findSaveBtn();
            if(save){
              ensureButtonsRow(save);
              // on click show the receipt button (even if save handler is async)
              save.addEventListener('click', function(){
                setTimeout(showReceiptBtn, 50);
              }, true);
            }
          }, 0);
        }
      }catch(e){}
      return ret;
    };
  }

  // Global safety net: if a click on any save button happens, reveal the receipt button after a moment
  document.addEventListener('click', function(ev){
    var t = ev.target;
    if(!t) return;
    var isSave = (t.id === 'savePay') || (String(t.textContent||'').trim().includes('Ø­ÙØ¸'));
    if(isSave) setTimeout(showReceiptBtn, 80);
  }, true);

  // Observe DOM for modal changes
  var mo = new MutationObserver(function(){
    patchOpenModal();
  });
  mo.observe(document.documentElement, {childList:true, subtree:true});

  // Initial
  patchOpenModal();
})();
// --- end injected v2 ---
</script>


<!-- === FIX v3: proper CSS injection and placeholders === -->
<script>
(function(){
  if (window.amountToArabicMoney) return;
  const ones = ['','ÙˆØ§Ø­Ø¯','Ø§Ø«Ù†Ø§Ù†','Ø«Ù„Ø§Ø«Ø©','Ø£Ø±Ø¨Ø¹Ø©','Ø®Ù…Ø³Ø©','Ø³ØªØ©','Ø³Ø¨Ø¹Ø©','Ø«Ù…Ø§Ù†ÙŠØ©','ØªØ³Ø¹Ø©'];
  const tens = ['','Ø¹Ø´Ø±Ø©','Ø¹Ø´Ø±ÙˆÙ†','Ø«Ù„Ø§Ø«ÙˆÙ†','Ø£Ø±Ø¨Ø¹ÙˆÙ†','Ø®Ù…Ø³ÙˆÙ†','Ø³ØªÙˆÙ†','Ø³Ø¨Ø¹ÙˆÙ†','Ø«Ù…Ø§Ù†ÙˆÙ†','ØªØ³Ø¹ÙˆÙ†'];
  const teens = ['Ø¹Ø´Ø±Ø©','Ø£Ø­Ø¯ Ø¹Ø´Ø±','Ø§Ø«Ù†Ø§ Ø¹Ø´Ø±','Ø«Ù„Ø§Ø«Ø© Ø¹Ø´Ø±','Ø£Ø±Ø¨Ø¹Ø© Ø¹Ø´Ø±','Ø®Ù…Ø³Ø© Ø¹Ø´Ø±','Ø³ØªØ© Ø¹Ø´Ø±','Ø³Ø¨Ø¹Ø© Ø¹Ø´Ø±','Ø«Ù…Ø§Ù†ÙŠØ© Ø¹Ø´Ø±','ØªØ³Ø¹Ø© Ø¹Ø´Ø±'];
  const hundreds = ['','Ù…Ø§Ø¦Ø©','Ù…Ø§Ø¦ØªØ§Ù†','Ø«Ù„Ø§Ø«Ù…Ø§Ø¦Ø©','Ø£Ø±Ø¨Ø¹Ù…Ø§Ø¦Ø©','Ø®Ù…Ø³Ù…Ø§Ø¦Ø©','Ø³ØªÙ…Ø§Ø¦Ø©','Ø³Ø¨Ø¹Ù…Ø§Ø¦Ø©','Ø«Ù…Ø§Ù†Ù…Ø§Ø¦Ø©','ØªØ³Ø¹Ù…Ø§Ø¦Ø©'];
  function three(n){
    let w=[]; n = Number(n)||0;
    const h = Math.floor(n/100), r = n%100, t = Math.floor(r/10), o = r%10;
    if(h) w.push(hundreds[h]);
    if(r){ if(r<10) w.push(ones[o]); else if(r<20) w.push(teens[o]); else { if(o) w.push(ones[o] + ' Ùˆ ' + tens[t]); else w.push(tens[t]); } }
    return w.filter(Boolean).join(' Ùˆ ');
  }
  function section(n, s, p, pl){ if(!n) return ''; let w=three(n); if(n==1) return s; if(n==2) return 'Ø§Ø«Ù†Ø§Ù† ' + p; if(n>=3 && n<=10) return w+' '+pl; return w+' '+p; }
  window.amountToArabicMoney = function(amount){
    amount = Number(amount||0);
    const rial = Math.floor(amount);
    const baisa = Math.round((amount - rial)*1000);
    let parts=[]; 
    if(rial===0) parts.push('ØµÙØ± Ø±ÙŠØ§Ù„ Ø¹Ù…Ø§Ù†ÙŠ');
    else { let s=[]; const b=Math.floor(rial/1_000_000_000), m=Math.floor((rial%1_000_000_000)/1_000_000), t=Math.floor((rial%1_000_000)/1000), r= rial%1000;
      if(b) s.push(section(b,'Ù…Ù„ÙŠØ§Ø±','Ù…Ù„ÙŠØ§Ø±Ù‹Ø§','Ù…Ù„ÙŠØ§Ø±Ø§Øª'));
      if(m) s.push(section(m,'Ù…Ù„ÙŠÙˆÙ†','Ù…Ù„ÙŠÙˆÙ†Ù‹Ø§','Ù…Ù„Ø§ÙŠÙŠÙ†'));
      if(t) s.push(section(t,'Ø£Ù„Ù','Ø£Ù„ÙÙ‹Ø§','Ø¢Ù„Ø§Ù'));
      if(r) s.push(three(r));
      parts.push(s.join(' Ùˆ ') + ' Ø±ÙŠØ§Ù„ Ø¹Ù…Ø§Ù†ÙŠ'); }
    if(baisa) parts.push('Ùˆ ' + three(baisa) + ' Ø¨ÙŠØ³Ø©');
    return parts.join(' ');
  }
})();

function openReceiptWindow({buildingName, tenantName, unitLabel, ym, note, amount}){

  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
    const win = window.open('', '_blank', 'width=980,height=900');
    if(!win) throw new Error('popup-blocked');
    const today = new Date(); const pad = (n)=> String(n).padStart(2,'0');
    const rvNo = today.getFullYear().toString().slice(2)+pad(today.getMonth()+1)+pad(today.getDate())+pad(today.getHours())+pad(today.getMinutes());
    const dateStr = (ym ? (ym + '-01') : today.toISOString().slice(0,10));
    let amt = (typeof amount==='number' && isFinite(amount)) ? amount : null;
    if(amt===null){ const m=(note||'').match(/\d+(?:[.,]\d+)?/); amt = m? Number(m[0].replace(',','.')):0; }
    const unitNum = (unitLabel||'').toString().replace(/^.*?(\d+).*$/, '$1');
    const purpose = unitNum ? ('Ø¥ÙŠØ¬Ø§Ø± Ø§Ù„Ø´Ù‚Ø© Ø±Ù‚Ù… ' + unitNum) : 'Ø¥ÙŠØ¬Ø§Ø±';
    const amountWords = amountToArabicMoney(amt);

    const css = `
      :root { --border:#d1d5db; --text:#0f172a; --muted:#6b7280; --accent:#1f6fff }
      *{box-sizing:border-box}
      html,body{background:#fff;font-family:"Tajawal","Noto Naskh Arabic","Segoe UI",system-ui; color:var(--text);}
      .wrap{max-width:900px;margin:22px auto;border:1px solid var(--border);border-radius:14px;overflow:hidden}
      header{display:flex;align-items:center;gap:12px;padding:16px;border-bottom:1px solid var(--border)}
      header img{height:64px;width:auto}
      header .title{display:flex;flex-direction:column;gap:6px}
      header .title b{font-size:20px}
      main{padding:16px}
      .row{display:flex;justify-content:space-between;gap:10px;margin:8px 0;flex-wrap:wrap}
      .label{color:var(--muted)}
      .line{border-bottom:1px dashed var(--border);flex:1;margin:0 8px}
      .box{border:1px solid var(--border); border-radius:10px; padding:10px; margin:8px 0}
      .foot{display:flex;justify-content:space-between;align-items:flex-end;gap:12px;margin-top:20px}
      .sig{min-height:54px;border-top:1px solid var(--border);padding-top:6px;text-align:center}
      .printbar{display:flex;justify-content:flex-end;gap:8px;padding:10px 14px;border-top:1px solid var(--border)}
      button{background:var(--accent);border:1px solid var(--accent);color:#fff;border-radius:10px;padding:10px 14px;cursor:pointer}
      @media print{ .printbar{display:none !important} .wrap{border:0} }
    `;

    const html = `<!DOCTYPE html>
    <html lang="ar" dir="rtl"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Ø³Ù†Ø¯ Ù‚Ø¨Ø¶ - Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø©</title>
    <style>${css}</style></head>
    <body>
    <div class="wrap">
      <header>
        <img src="data:image/jpeg;base64,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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8QAAv/aAAwDAQACAAMAAAAQ8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888/888888888888888888888888888888888888g5t8888888yyz08888888888888888888888888r9Qk60885Cf8pf88888888888888888888888887p8ttJ84lWrsuqVV8888888888888888888888+5Lj888MrQUlhLxXx2598888888888888888888885uxb+oi+9/BkW98R/P08888888888888888888884DE/eupPMB4wxEm/NEV8888888888888888888J1evKhek9tJ+QyJ4UPuW8888888888888888888ZS2mVayKcft+EMda8MtLb888888888888888888qSuV8u2ctdAVGBKdM3KVc8888888888888888855LIQ3u7prGFqSMC/+TK2s88888888888888888v6EoqYFn7b+BfR8Xh6FyRV88888888888888888/VovMKwgDfrX+s9cotcEIo88888888888888888/sRxwwRpny038xxbWMXYq48888888888888880wOVur7WuM4tDIrpPh1sShzBQx8888888888888qWRGhoXNOPo3sf0i7WZ0VtDzf668888888888887wBVZpAf8AXs7/AP8Aj1DfW/hcmzQYH88888888888888P40848988cM888t88sff88888888888888888888JuVdSV/3LG1SV3/EwSWKMef8APPPPPPPPPPPPPPPLhMfb/wBz/wA8svtdNfe/s1v3c8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888//8QANREAAQQABAMHAQcEAwAAAAAAAQACAxEEEiExMkFxBRATIjNAUUIUICMwNFJhFSSAgVByof/aAAgBAgEBPwD/ABCDXEE1oP8AhRhJHRh7dQmQSvkDMhsrFYRmH7PLQPNpZ/Iyn4WV3wsrv2n3eFkJa6LNV7FMxk8T97I+VJ2j48To5G1fNOjH0utEEcvu5SoGgRtsWqb+1BrVL6jvddmYAvuV+g5LtLDmKXMBo7vzH7jWrRQ+m1c1qpATK7qsnuGmiDS/qmIADW00D4CGJkxGZkr7vZEUSOY+5FhC9gOZHB5RmzLKfhUoh+E1bBBxTYmve8k0bX2dg+opzCXmgjE/9vuAaIPNSAPBkHxr1TACUIwbRBBWF9FqcfKjVbFO3Ki9JqKCbKGOfpzX2gH6Vhjb39Uap1hO4imgUnNr2zJC1rm8imXaqmgh2qdqCsN6TeikJDEZRexRIJKh9JqKCefO/qtVhQQXI8JTuIpkdsBtMpo8zU+sxr2mFia8uzBSwRNicQNVHQdqgMxNDRG9VhvTb0UvAVzKPNQ+k1bhBOoSP6rOK4Ux9OtNeC0pwOY9UzNXRF5dvyR39pgfqRaHCjsp4Y2ssBat2Rqj8rD+mzopTbCjzTW5nHVQMtgFpwo1aCfxu6obrRQrCtBDiReqcxmQ+VRRCRxTsCL4lIzI8t9ngN3IbqduZlJ7S1265HRQekzopOAr5TLBKw3CpALQaSpInh7rHPujAJWAw8cs1H4KnwkeGcQ3Y6p3CVhONycVivWd7PAjVyG6nNMJTyXPukxoLgmta1oACl0YUeabuVhuD/Sl3Ci4VjD5h07ol2UP7g9Cu0fUHQJ3A5YXjcjaxPqu9kN1g+aCxPAFeqZx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" alt="Logo">
        <div class="title">
          <b>Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù…ØªÙ„ÙƒØ§Øª Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ©</b>
          <div class="label">Ø³Ù†Ø¯ Ù‚Ø¨Ø¶ (Receipt Voucher)</div>
        </div>
        <div style="margin-inline-start:auto;text-align:left">
          <div>Ø±Ù‚Ù… Ø§Ù„Ø³Ù†Ø¯: <span>${rvNo}</span></div>
          <div>Ø§Ù„ØªØ§Ø±ÙŠØ®: <span>${dateStr}</span></div>
        </div>
      </header>
      <main>
        <div class="row"><div class="label">Ø§Ø³ØªÙ„Ù…Ù†Ø§ Ù…Ù† Ø§Ù„ÙØ§Ø¶Ù„:</div><div class="line"></div><div>${tenantName||'â€”'}</div></div>
        <div class="row"><div class="label">Ù…Ø¨Ù„Øº ÙˆÙ‚Ø¯Ø±Ù‡:</div><div class="line"></div><div>${amountWords}</div></div>
        <div class="row"><div class="label">(Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù…)</div><div class="line"></div><div>${amt.toFixed(3)} Ø±.Ø¹</div></div>
        <div class="row box" style="align-items:center">
          <div class="label">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</div>
          <div style="display:flex;gap:14px;align-items:center">
            <label><input type="radio" name="method" value="Ù†Ù‚Ø¯Ù‹Ø§" checked> Ù†Ù‚Ø¯Ù‹Ø§</label>
            <label><input type="radio" name="method" value="Ø´ÙŠÙƒ"> Ø´ÙŠÙƒ Ø±Ù‚Ù…</label>
            <input id="chequeNo" placeholder="â€”" style="border:1px solid var(--border);border-radius:8px;padding:6px 8px;width:160px">
          </div>
        </div>
        <div class="row"><div class="label">Ø¨ØªØ§Ø±ÙŠØ®:</div><div class="line"></div><div>${dateStr}</div></div>
        <div class="row"><div class="label">ÙˆØ°Ù„Ùƒ Ø¹Ù†:</div><div class="line"></div><div>${purpose}</div></div>
        <div class="foot"><div style="min-width:260px"><div class="sig">ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ„Ù…</div></div></div>
      </main>
      <div class="printbar"><button onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button></div>
    </div>
    </body></html>`;

    win.document.open();
    win.document.write(html);
    win.document.close();
  }catch(e){
    // alert removed; see console.
    console.error(e);
  }
}
</script>

</body></html>';= "<script>window.__PAYLOAD__=" + JSON.stringify(data) + ";</" + "script>";
    var html = tpl.replace("</head>", "</head>" + bootstrap);
    var blob = new Blob([html], {type:"text/html;charset=utf-8"});
    var url = URL.createObjectURL(blob);
    window.open(url, "_blank", "noopener");
    setTimeout(function(){ URL.revokeObjectURL(url); }, 60000);
  } catch(e) {
    console.error("openReceiptWindow failed", e);
    alert("ØªØ¹Ø°Ø± ÙØªØ­ Ø³Ù†Ø¯ Ø§Ù„Ù‚Ø¨Ø¶");
  }
};
// --- end injected ---
</script>





<script>
// --- injected v2: robust alignment + show-after-save ---
(function(){
  function findSaveBtn(){
    // Try by id
    var btn = document.getElementById('savePay');
    if(btn) return btn;
    // Fallback: search in open modal for a button contains 'Ø­ÙØ¸'
    var modals = document.querySelectorAll('.modal, [role="dialog"], .swal2-popup');
    for (var m of modals){
      var cand = Array.from(m.querySelectorAll('button, .btn')).find(b=>String(b.textContent||'').trim().includes('Ø­ÙØ¸'));
      if(cand) return cand;
    }
    // Global search
    return Array.from(document.querySelectorAll('button, .btn')).find(b=>String(b.textContent||'').trim().includes('Ø­ÙØ¸'));
  }

  function ensureButtonsRow(save){
    // Create or find row
    var row = save && save.closest('.buttons-row');
    if(!row){
      row = document.createElement('div');
      row.className = 'buttons-row';
      var host = (save && (save.closest('.row') || save.parentElement)) || document.body;
      if(host && host.parentElement){
        host.parentElement.insertBefore(row, host.nextSibling);
      }else{
        document.body.appendChild(row);
      }
      if(save) row.appendChild(save);
    }
    // Create or move receipt button
    var btn = document.getElementById('issueReceiptBtn');
    if(!btn){
      btn = document.createElement('button');
      btn.id = 'issueReceiptBtn';
      btn.type = 'button';
      btn.className = 'btn primary btn--sm hidden';
      btn.textContent = 'ğŸ§¾ Ø¥ØµØ¯Ø§Ø± Ø¥ÙŠØµØ§Ù„';
    }else{
      btn.classList.remove('block','full','w-100');
      btn.classList.add('btn','primary','btn--sm');
    }
    row.appendChild(btn);
    // Click handler for opening receipt
    if(!btn.__bound){
      btn.__bound = true;
      btn.addEventListener('click', function(){
      
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
          var amountNote = (document.getElementById('payNote')?.value || '').trim();
          // Try to parse a number from note
          var amtMatch = amountNote.match(/\d+(?:[.,]\d+)?/);
          var amount = amtMatch ? parseFloat(amtMatch[0].replace(',','.')) : 0;
          var tenantName = window.currentTenant?.name || window.currentTenant?.tenantName || '';
          var unitLabel = (window.currentTenant?.unitNumber || window.currentTenant?.unit?.number) ? ('Ø´Ù‚Ø© ' + (window.currentTenant.unitNumber || window.currentTenant.unit.number)) : (window.currentTenant?.unit || '');
          var ym = window.selectedYearMonth || '';
          var buildingName = window.currentBuilding?.name || '';
          if(typeof openReceiptWindow === 'function'){
            openReceiptWindow({tenantName, amount, unitLabel, ym, buildingName, print:true});
          }else{
            alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¯ÙØ¹. (Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯Ø§Ù„Ø© openReceiptWindow)');
          }
        }catch(e){ console.warn(e); }
      });
    }
    return btn;
  }

  function showReceiptBtn(){
    var save = findSaveBtn();
    if(!save) return;
    var btn = ensureButtonsRow(save);
    btn.classList.remove('hidden');
  }

  // Hook to openModal if available & also use MutationObserver for safety
  var patched = false;
  function patchOpenModal(){
    if(patched) return;
    var _om = window.openModal;
    if(!_om) return;
    patched = true;
    window.openModal = function(title, html){
      var ret = _om.apply(this, arguments);
    
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
        if(/ØªØ³Ø¬ÙŠÙ„\s*Ø¯ÙØ¹/i.test(String(title)) || /pay/i.test(String(title))){
          // Wait a tick for DOM to render
          setTimeout(function(){
            var save = findSaveBtn();
            if(save){
              ensureButtonsRow(save);
              // on click show the receipt button (even if save handler is async)
              save.addEventListener('click', function(){
                setTimeout(showReceiptBtn, 50);
              }, true);
            }
          }, 0);
        }
      }catch(e){}
      return ret;
    };
  }

  // Global safety net: if a click on any save button happens, reveal the receipt button after a moment
  document.addEventListener('click', function(ev){
    var t = ev.target;
    if(!t) return;
    var isSave = (t.id === 'savePay') || (String(t.textContent||'').trim().includes('Ø­ÙØ¸'));
    if(isSave) setTimeout(showReceiptBtn, 80);
  }, true);

  // Observe DOM for modal changes
  var mo = new MutationObserver(function(){
    patchOpenModal();
  });
  mo.observe(document.documentElement, {childList:true, subtree:true});

  // Initial
  patchOpenModal();
})();
// --- end injected v2 ---
</script>


<!-- === FIX v3: proper CSS injection and placeholders === -->
<script>
(function(){
  if (window.amountToArabicMoney) return;
  const ones = ['','ÙˆØ§Ø­Ø¯','Ø§Ø«Ù†Ø§Ù†','Ø«Ù„Ø§Ø«Ø©','Ø£Ø±Ø¨Ø¹Ø©','Ø®Ù…Ø³Ø©','Ø³ØªØ©','Ø³Ø¨Ø¹Ø©','Ø«Ù…Ø§Ù†ÙŠØ©','ØªØ³Ø¹Ø©'];
  const tens = ['','Ø¹Ø´Ø±Ø©','Ø¹Ø´Ø±ÙˆÙ†','Ø«Ù„Ø§Ø«ÙˆÙ†','Ø£Ø±Ø¨Ø¹ÙˆÙ†','Ø®Ù…Ø³ÙˆÙ†','Ø³ØªÙˆÙ†','Ø³Ø¨Ø¹ÙˆÙ†','Ø«Ù…Ø§Ù†ÙˆÙ†','ØªØ³Ø¹ÙˆÙ†'];
  const teens = ['Ø¹Ø´Ø±Ø©','Ø£Ø­Ø¯ Ø¹Ø´Ø±','Ø§Ø«Ù†Ø§ Ø¹Ø´Ø±','Ø«Ù„Ø§Ø«Ø© Ø¹Ø´Ø±','Ø£Ø±Ø¨Ø¹Ø© Ø¹Ø´Ø±','Ø®Ù…Ø³Ø© Ø¹Ø´Ø±','Ø³ØªØ© Ø¹Ø´Ø±','Ø³Ø¨Ø¹Ø© Ø¹Ø´Ø±','Ø«Ù…Ø§Ù†ÙŠØ© Ø¹Ø´Ø±','ØªØ³Ø¹Ø© Ø¹Ø´Ø±'];
  const hundreds = ['','Ù…Ø§Ø¦Ø©','Ù…Ø§Ø¦ØªØ§Ù†','Ø«Ù„Ø§Ø«Ù…Ø§Ø¦Ø©','Ø£Ø±Ø¨Ø¹Ù…Ø§Ø¦Ø©','Ø®Ù…Ø³Ù…Ø§Ø¦Ø©','Ø³ØªÙ…Ø§Ø¦Ø©','Ø³Ø¨Ø¹Ù…Ø§Ø¦Ø©','Ø«Ù…Ø§Ù†Ù…Ø§Ø¦Ø©','ØªØ³Ø¹Ù…Ø§Ø¦Ø©'];
  function three(n){
    let w=[]; n = Number(n)||0;
    const h = Math.floor(n/100), r = n%100, t = Math.floor(r/10), o = r%10;
    if(h) w.push(hundreds[h]);
    if(r){ if(r<10) w.push(ones[o]); else if(r<20) w.push(teens[o]); else { if(o) w.push(ones[o] + ' Ùˆ ' + tens[t]); else w.push(tens[t]); } }
    return w.filter(Boolean).join(' Ùˆ ');
  }
  function section(n, s, p, pl){ if(!n) return ''; let w=three(n); if(n==1) return s; if(n==2) return 'Ø§Ø«Ù†Ø§Ù† ' + p; if(n>=3 && n<=10) return w+' '+pl; return w+' '+p; }
  window.amountToArabicMoney = function(amount){
    amount = Number(amount||0);
    const rial = Math.floor(amount);
    const baisa = Math.round((amount - rial)*1000);
    let parts=[]; 
    if(rial===0) parts.push('ØµÙØ± Ø±ÙŠØ§Ù„ Ø¹Ù…Ø§Ù†ÙŠ');
    else { let s=[]; const b=Math.floor(rial/1_000_000_000), m=Math.floor((rial%1_000_000_000)/1_000_000), t=Math.floor((rial%1_000_000)/1000), r= rial%1000;
      if(b) s.push(section(b,'Ù…Ù„ÙŠØ§Ø±','Ù…Ù„ÙŠØ§Ø±Ù‹Ø§','Ù…Ù„ÙŠØ§Ø±Ø§Øª'));
      if(m) s.push(section(m,'Ù…Ù„ÙŠÙˆÙ†','Ù…Ù„ÙŠÙˆÙ†Ù‹Ø§','Ù…Ù„Ø§ÙŠÙŠÙ†'));
      if(t) s.push(section(t,'Ø£Ù„Ù','Ø£Ù„ÙÙ‹Ø§','Ø¢Ù„Ø§Ù'));
      if(r) s.push(three(r));
      parts.push(s.join(' Ùˆ ') + ' Ø±ÙŠØ§Ù„ Ø¹Ù…Ø§Ù†ÙŠ'); }
    if(baisa) parts.push('Ùˆ ' + three(baisa) + ' Ø¨ÙŠØ³Ø©');
    return parts.join(' ');
  }
})();

function openReceiptWindow({buildingName, tenantName, unitLabel, ym, note, amount}){

  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
    const win = window.open('', '_blank', 'width=980,height=900');
    if(!win) throw new Error('popup-blocked');
    const today = new Date(); const pad = (n)=> String(n).padStart(2,'0');
    const rvNo = today.getFullYear().toString().slice(2)+pad(today.getMonth()+1)+pad(today.getDate())+pad(today.getHours())+pad(today.getMinutes());
    const dateStr = (ym ? (ym + '-01') : today.toISOString().slice(0,10));
    let amt = (typeof amount==='number' && isFinite(amount)) ? amount : null;
    if(amt===null){ const m=(note||'').match(/\d+(?:[.,]\d+)?/); amt = m? Number(m[0].replace(',','.')):0; }
    const unitNum = (unitLabel||'').toString().replace(/^.*?(\d+).*$/, '$1');
    const purpose = unitNum ? ('Ø¥ÙŠØ¬Ø§Ø± Ø§Ù„Ø´Ù‚Ø© Ø±Ù‚Ù… ' + unitNum) : 'Ø¥ÙŠØ¬Ø§Ø±';
    const amountWords = amountToArabicMoney(amt);

    const css = `
      :root { --border:#d1d5db; --text:#0f172a; --muted:#6b7280; --accent:#1f6fff }
      *{box-sizing:border-box}
      html,body{background:#fff;font-family:"Tajawal","Noto Naskh Arabic","Segoe UI",system-ui; color:var(--text);}
      .wrap{max-width:900px;margin:22px auto;border:1px solid var(--border);border-radius:14px;overflow:hidden}
      header{display:flex;align-items:center;gap:12px;padding:16px;border-bottom:1px solid var(--border)}
      header img{height:64px;width:auto}
      header .title{display:flex;flex-direction:column;gap:6px}
      header .title b{font-size:20px}
      main{padding:16px}
      .row{display:flex;justify-content:space-between;gap:10px;margin:8px 0;flex-wrap:wrap}
      .label{color:var(--muted)}
      .line{border-bottom:1px dashed var(--border);flex:1;margin:0 8px}
      .box{border:1px solid var(--border); border-radius:10px; padding:10px; margin:8px 0}
      .foot{display:flex;justify-content:space-between;align-items:flex-end;gap:12px;margin-top:20px}
      .sig{min-height:54px;border-top:1px solid var(--border);padding-top:6px;text-align:center}
      .printbar{display:flex;justify-content:flex-end;gap:8px;padding:10px 14px;border-top:1px solid var(--border)}
      button{background:var(--accent);border:1px solid var(--accent);color:#fff;border-radius:10px;padding:10px 14px;cursor:pointer}
      @media print{ .printbar{display:none !important} .wrap{border:0} }
    `;

    const html = `<!DOCTYPE html>
    <html lang="ar" dir="rtl"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Ø³Ù†Ø¯ Ù‚Ø¨Ø¶ - Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø©</title>
    <style>${css}</style></head>
    <body>
    <div class="wrap">
      <header>
        <img src="data:image/jpeg;base64,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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8QAAv/aAAwDAQACAAMAAAAQ8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888/888888888888888888888888888888888888g5t8888888yyz08888888888888888888888888r9Qk60885Cf8pf88888888888888888888888887p8ttJ84lWrsuqVV8888888888888888888888+5Lj888MrQUlhLxXx2598888888888888888888885uxb+oi+9/BkW98R/P08888888888888888888884DE/eupPMB4wxEm/NEV8888888888888888888J1evKhek9tJ+QyJ4UPuW8888888888888888888ZS2mVayKcft+EMda8MtLb888888888888888888qSuV8u2ctdAVGBKdM3KVc8888888888888888855LIQ3u7prGFqSMC/+TK2s88888888888888888v6EoqYFn7b+BfR8Xh6FyRV88888888888888888/VovMKwgDfrX+s9cotcEIo88888888888888888/sRxwwRpny038xxbWMXYq48888888888888880wOVur7WuM4tDIrpPh1sShzBQx8888888888888qWRGhoXNOPo3sf0i7WZ0VtDzf668888888888887wBVZpAf8AXs7/AP8Aj1DfW/hcmzQYH88888888888888P40848988cM888t88sff88888888888888888888JuVdSV/3LG1SV3/EwSWKMef8APPPPPPPPPPPPPPPLhMfb/wBz/wA8svtdNfe/s1v3c8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888//8QANREAAQQABAMHAQcEAwAAAAAAAQACAxEEEiExMkFxBRATIjNAUUIUICMwNFJhFSSAgVByof/aAAgBAgEBPwD/ABCDXEE1oP8AhRhJHRh7dQmQSvkDMhsrFYRmH7PLQPNpZ/Iyn4WV3wsrv2n3eFkJa6LNV7FMxk8T97I+VJ2j48To5G1fNOjH0utEEcvu5SoGgRtsWqb+1BrVL6jvddmYAvuV+g5LtLDmKXMBo7vzH7jWrRQ+m1c1qpATK7qsnuGmiDS/qmIADW00D4CGJkxGZkr7vZEUSOY+5FhC9gOZHB5RmzLKfhUoh+E1bBBxTYmve8k0bX2dg+opzCXmgjE/9vuAaIPNSAPBkHxr1TACUIwbRBBWF9FqcfKjVbFO3Ki9JqKCbKGOfpzX2gH6Vhjb39Uap1hO4imgUnNr2zJC1rm8imXaqmgh2qdqCsN6TeikJDEZRexRIJKh9JqKCefO/qtVhQQXI8JTuIpkdsBtMpo8zU+sxr2mFia8uzBSwRNicQNVHQdqgMxNDRG9VhvTb0UvAVzKPNQ+k1bhBOoSP6rOK4Ux9OtNeC0pwOY9UzNXRF5dvyR39pgfqRaHCjsp4Y2ssBat2Rqj8rD+mzopTbCjzTW5nHVQMtgFpwo1aCfxu6obrRQrCtBDiReqcxmQ+VRRCRxTsCL4lIzI8t9ngN3IbqduZlJ7S1265HRQekzopOAr5TLBKw3CpALQaSpInh7rHPujAJWAw8cs1H4KnwkeGcQ3Y6p3CVhONycVivWd7PAjVyG6nNMJTyXPukxoLgmta1oACl0YUeabuVhuD/Sl3Ci4VjD5h07ol2UP7g9Cu0fUHQJ3A5YXjcjaxPqu9kN1g+aCxPAFeqZx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" alt="Logo">
        <div class="title">
          <b>Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù…ØªÙ„ÙƒØ§Øª Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ©</b>
          <div class="label">Ø³Ù†Ø¯ Ù‚Ø¨Ø¶ (Receipt Voucher)</div>
        </div>
        <div style="margin-inline-start:auto;text-align:left">
          <div>Ø±Ù‚Ù… Ø§Ù„Ø³Ù†Ø¯: <span>${rvNo}</span></div>
          <div>Ø§Ù„ØªØ§Ø±ÙŠØ®: <span>${dateStr}</span></div>
        </div>
      </header>
      <main>
        <div class="row"><div class="label">Ø§Ø³ØªÙ„Ù…Ù†Ø§ Ù…Ù† Ø§Ù„ÙØ§Ø¶Ù„:</div><div class="line"></div><div>${tenantName||'â€”'}</div></div>
        <div class="row"><div class="label">Ù…Ø¨Ù„Øº ÙˆÙ‚Ø¯Ø±Ù‡:</div><div class="line"></div><div>${amountWords}</div></div>
        <div class="row"><div class="label">(Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù…)</div><div class="line"></div><div>${amt.toFixed(3)} Ø±.Ø¹</div></div>
        <div class="row box" style="align-items:center">
          <div class="label">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</div>
          <div style="display:flex;gap:14px;align-items:center">
            <label><input type="radio" name="method" value="Ù†Ù‚Ø¯Ù‹Ø§" checked> Ù†Ù‚Ø¯Ù‹Ø§</label>
            <label><input type="radio" name="method" value="Ø´ÙŠÙƒ"> Ø´ÙŠÙƒ Ø±Ù‚Ù…</label>
            <input id="chequeNo" placeholder="â€”" style="border:1px solid var(--border);border-radius:8px;padding:6px 8px;width:160px">
          </div>
        </div>
        <div class="row"><div class="label">Ø¨ØªØ§Ø±ÙŠØ®:</div><div class="line"></div><div>${dateStr}</div></div>
        <div class="row"><div class="label">ÙˆØ°Ù„Ùƒ Ø¹Ù†:</div><div class="line"></div><div>${purpose}</div></div>
        <div class="foot"><div style="min-width:260px"><div class="sig">ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ„Ù…</div></div></div>
      </main>
      <div class="printbar"><button onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button></div>
    </div>
    </body></html>`;

    win.document.open();
    win.document.write(html);
    win.document.close();
  }catch(e){
    // alert removed; see console.
    console.error(e);
  }
}
</script>

</body>
</html>

<script>
window.addEventListener('load', function(){
  if(typeof __attachBuildingSearch==='function') __attachBuildingSearch();
});
</script>

<script>
// --- override v4: bigger layout + safer autofill + no alerts ---
window.openReceiptWindow = function(payload){

  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{
    // Safe fallbacks from current UI if payload incomplete
    var p = payload || {};
    var payNoteEl = document.getElementById('payNote');
    var noteTxt = p.note || (payNoteEl ? (payNoteEl.value||'').trim() : '');
    var amt = (typeof p.amount==='number' && isFinite(p.amount)) ? p.amount : (function(){
      var m = (noteTxt||'').match(/\d+(?:[.,]\d+)?/);
      return m ? parseFloat(m[0].replace(',','.')) : 0;
    })();
    var tenantName = p.tenantName || (window.currentTenant && (window.currentTenant.name || window.currentTenant.tenantName)) || '';
    var unitLabel  = p.unitLabel  || (window.currentTenant && (window.currentTenant.unit && (window.currentTenant.unit.number ? ('Ø´Ù‚Ø© ' + window.currentTenant.unit.number) : window.currentTenant.unit))) || '';
    var buildingName = p.buildingName || (window.currentBuilding && window.currentBuilding.name) || '';
    var ym = p.ym || (window.selectedYearMonth || new Date().toISOString().slice(0,7));
    var now = new Date();
    var rvNo = (now.getFullYear()) + String(now.getMonth()+1).padStart(2,'0') + String(now.getDate()).padStart(2,'0') + String(now.getHours()).padStart(2,'0') + String(now.getMinutes()).padStart(2,'0');

    // number to Arabic words
    function toWords(amount){
      const ones = ['','ÙˆØ§Ø­Ø¯','Ø§Ø«Ù†Ø§Ù†','Ø«Ù„Ø§Ø«Ø©','Ø£Ø±Ø¨Ø¹Ø©','Ø®Ù…Ø³Ø©','Ø³ØªØ©','Ø³Ø¨Ø¹Ø©','Ø«Ù…Ø§Ù†ÙŠØ©','ØªØ³Ø¹Ø©'];
      const tens = ['','Ø¹Ø´Ø±Ø©','Ø¹Ø´Ø±ÙˆÙ†','Ø«Ù„Ø§Ø«ÙˆÙ†','Ø£Ø±Ø¨Ø¹ÙˆÙ†','Ø®Ù…Ø³ÙˆÙ†','Ø³ØªÙˆÙ†','Ø³Ø¨Ø¹ÙˆÙ†','Ø«Ù…Ø§Ù†ÙˆÙ†','ØªØ³Ø¹ÙˆÙ†'];
      const teens = ['Ø¹Ø´Ø±Ø©','Ø£Ø­Ø¯ Ø¹Ø´Ø±','Ø§Ø«Ù†Ø§ Ø¹Ø´Ø±','Ø«Ù„Ø§Ø«Ø© Ø¹Ø´Ø±','Ø£Ø±Ø¨Ø¹Ø© Ø¹Ø´Ø±','Ø®Ù…Ø³Ø© Ø¹Ø´Ø±','Ø³ØªØ© Ø¹Ø´Ø±','Ø³Ø¨Ø¹Ø© Ø¹Ø´Ø±','Ø«Ù…Ø§Ù†ÙŠØ© Ø¹Ø´Ø±','ØªØ³Ø¹Ø© Ø¹Ø´Ø±'];
      const hundreds = ['','Ù…Ø§Ø¦Ø©','Ù…Ø§Ø¦ØªØ§Ù†','Ø«Ù„Ø§Ø«Ù…Ø§Ø¦Ø©','Ø£Ø±Ø¨Ø¹Ù…Ø§Ø¦Ø©','Ø®Ù…Ø³Ù…Ø§Ø¦Ø©','Ø³ØªÙ…Ø§Ø¦Ø©','Ø³Ø¨Ø¹Ù…Ø§Ø¦Ø©','Ø«Ù…Ø§Ù†Ù…Ø§Ø¦Ø©','ØªØ³Ø¹Ù…Ø§Ø¦Ø©'];
      function three(n){
        let w=[]; n = Number(n)||0;
        const h = Math.floor(n/100), r = n%100, t = Math.floor(r/10), o = r%10;
        if(h) w.push(hundreds[h]);
        if(r){ if(r<10) w.push(ones[o]); else if(r<20) w.push(teens[o]); else { if(o) w.push(ones[o] + ' Ùˆ ' + tens[t]); else w.push(tens[t]); } }
        return w.filter(Boolean).join(' Ùˆ ');
      }
      function section(n, s, p, pl){ if(!n) return ''; let w=three(n); if(n==1) return s; if(n==2) return 'Ø§Ø«Ù†Ø§Ù† ' + p; if(n>=3 && n<=10) return w+' '+pl; return w+' '+p; }
      amount = Number(amount||0);
      const rial = Math.floor(amount);
      const baisa = Math.round((amount - rial)*1000);
      let parts=[];
      if(rial===0) parts.push('ØµÙØ± Ø±ÙŠØ§Ù„ Ø¹Ù…Ø§Ù†ÙŠ');
      else { let s=[]; const b=Math.floor(rial/1_000_000_000), m=Math.floor((rial%1_000_000_000)/1_000_000), t=Math.floor((rial%1_000_000)/1000), r=rial%1000;
        if(b) s.push(section(b,'Ù…Ù„ÙŠØ§Ø±','Ù…Ù„ÙŠØ§Ø±Ù‹Ø§','Ù…Ù„ÙŠØ§Ø±Ø§Øª'));
        if(m) s.push(section(m,'Ù…Ù„ÙŠÙˆÙ†','Ù…Ù„ÙŠÙˆÙ†Ù‹Ø§','Ù…Ù„Ø§ÙŠÙŠÙ†'));
        if(t) s.push(section(t,'Ø£Ù„Ù','Ø£Ù„ÙÙ‹Ø§','Ø¢Ù„Ø§Ù'));
        if(r) s.push(three(r));
        parts.push(s.join(' Ùˆ ') + ' Ø±ÙŠØ§Ù„ Ø¹Ù…Ø§Ù†ÙŠ');
      }
      if(baisa) parts.push('Ùˆ ' + three(baisa) + ' Ø¨ÙŠØ³Ø©');
      return parts.join(' ');
    }

    // Styles: bigger paper and fonts
    var css = `
      :root { --border:#d1d5db; --text:#0f172a; --muted:#6b7280; --accent:#1f6fff }
      *{box-sizing:border-box}
      html,body{background:#fff;font-family:"Tajawal","Noto Naskh Arabic","Segoe UI",system-ui;color:var(--text);font-size:18px}
      .wrap{max-width:1100px;margin:32px auto;border:1px solid var(--border);border-radius:16px;overflow:hidden}
      header{display:flex;align-items:center;gap:16px;padding:20px;border-bottom:1px solid var(--border)}
      header img{height:84px;width:auto}
      header .title{display:flex;flex-direction:column;gap:6px}
      header .title b{font-size:24px}
      main{padding:20px}
      .row{display:flex;justify-content:space-between;gap:12px;margin:12px 0;flex-wrap:wrap}
      .label{color:var(--muted)}
      .line{border-bottom:1px dashed var(--border);flex:1;margin:0 8px}
      .box{border:1px solid var(--border); border-radius:12px; padding:12px; margin:10px 0}
      .foot{display:flex;justify-content:space-between;align-items:flex-end;gap:12px;margin-top:24px}
      .sig{min-height:64px;border-top:1px solid var(--border);padding-top:8px;text-align:center}
      .printbar{display:flex;justify-content:flex-end;gap:8px;padding:12px 16px;border-top:1px solid var(--border)}
      button{background:var(--accent);border:1px solid var(--accent);color:#fff;border-radius:10px;padding:10px 16px;cursor:pointer}
      @media print{ .printbar{display:none !important} .wrap{border:0} }
    `;

    var logo = '%LOGO_B64%';
    var html = \`<!DOCTYPE html>
    <html lang="ar" dir="rtl"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Ø³Ù†Ø¯ Ù‚Ø¨Ø¶ - Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø©</title>
    <style>\${css}</style></head>
    <body>
    <div class="wrap">
      <header>
        <img src="\${logo}" alt="Logo">
        <div class="title">
          <b>Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù…ØªÙ„ÙƒØ§Øª Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠØ©</b>
          <div class="label">Ø³Ù†Ø¯ Ù‚Ø¨Ø¶ (Receipt Voucher)</div>
        </div>
        <div style="margin-inline-start:auto;text-align:left">
          <div>Ø±Ù‚Ù… Ø§Ù„Ø³Ù†Ø¯: <span>\${rvNo}</span></div>
          <div>Ø§Ù„ØªØ§Ø±ÙŠØ®: <span>\${ym ? (ym + '-01') : new Date().toISOString().slice(0,10)}</span></div>
        </div>
      </header>
      <main>
        <div class="row"><div class="label">Ø§Ø³ØªÙ„Ù…Ù†Ø§ Ù…Ù† Ø§Ù„ÙØ§Ø¶Ù„:</div><div class="line"></div><div>\${tenantName || 'â€”'}</div></div>
        <div class="row"><div class="label">Ù…Ø¨Ù„Øº ÙˆÙ‚Ø¯Ø±Ù‡:</div><div class="line"></div><div>\${toWords(amt)}</div></div>
        <div class="row"><div class="label">(Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù…)</div><div class="line"></div><div>\${amt.toFixed(3)} Ø±.Ø¹</div></div>
        <div class="row box" style="align-items:center">
          <div class="label">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</div>
          <div style="display:flex;gap:14px;align-items:center">
            <label><input type="radio" name="method" value="Ù†Ù‚Ø¯Ù‹Ø§" checked> Ù†Ù‚Ø¯Ù‹Ø§</label>
            <label><input type="radio" name="method" value="Ø´ÙŠÙƒ"> Ø´ÙŠÙƒ Ø±Ù‚Ù…</label>
            <input id="chequeNo" placeholder="â€”" style="border:1px solid var(--border);border-radius:8px;padding:6px 8px;width:180px">
          </div>
        </div>
        <div class="row"><div class="label">Ø¨ØªØ§Ø±ÙŠØ®:</div><div class="line"></div><div>\${ym ? (ym + '-01') : new Date().toISOString().slice(0,10)}</div></div>
        <div class="row"><div class="label">ÙˆØ°Ù„Ùƒ Ø¹Ù†:</div><div class="line"></div><div>\${unitLabel ? ('Ø¥ÙŠØ¬Ø§Ø± Ø§Ù„Ø´Ù‚Ø© Ø±Ù‚Ù… ' + String(unitLabel).replace(/[^0-9]/g,'')) : 'Ø¥ÙŠØ¬Ø§Ø±'}</div></div>
        <div class="foot"><div style="min-width:300px"><div class="sig">ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ„Ù…</div></div></div>
      </main>
      <div class="printbar"><button onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button></div>
    </div>
    </body></html>\`;

    var win = window.open('', '_blank', 'width=1200,height=900');
    if(!win) return console.error('Popup blocked');
    win.document.open();
    win.document.write(html.replace('%LOGO_B64%','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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8QAAv/aAAwDAQACAAMAAAAQ8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888/888888888888888888888888888888888888g5t8888888yyz08888888888888888888888888r9Qk60885Cf8pf88888888888888888888888887p8ttJ84lWrsuqVV8888888888888888888888+5Lj888MrQUlhLxXx2598888888888888888888885uxb+oi+9/BkW98R/P08888888888888888888884DE/eupPMB4wxEm/NEV8888888888888888888J1evKhek9tJ+QyJ4UPuW8888888888888888888ZS2mVayKcft+EMda8MtLb888888888888888888qSuV8u2ctdAVGBKdM3KVc8888888888888888855LIQ3u7prGFqSMC/+TK2s88888888888888888v6EoqYFn7b+BfR8Xh6FyRV88888888888888888/VovMKwgDfrX+s9cotcEIo88888888888888888/sRxwwRpny038xxbWMXYq48888888888888880wOVur7WuM4tDIrpPh1sShzBQx8888888888888qWRGhoXNOPo3sf0i7WZ0VtDzf668888888888887wBVZpAf8AXs7/AP8Aj1DfW/hcmzQYH88888888888888P40848988cM888t88sff88888888888888888888JuVdSV/3LG1SV3/EwSWKMef8APPPPPPPPPPPPPPPLhMfb/wBz/wA8svtdNfe/s1v3c8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888//8QANREAAQQABAMHAQcEAwAAAAAAAQACAxEEEiExMkFxBRATIjNAUUIUICMwNFJhFSSAgVByof/aAAgBAgEBPwD/ABCDXEE1oP8AhRhJHRh7dQmQSvkDMhsrFYRmH7PLQPNpZ/Iyn4WV3wsrv2n3eFkJa6LNV7FMxk8T97I+VJ2j48To5G1fNOjH0utEEcvu5SoGgRtsWqb+1BrVL6jvddmYAvuV+g5LtLDmKXMBo7vzH7jWrRQ+m1c1qpATK7qsnuGmiDS/qmIADW00D4CGJkxGZkr7vZEUSOY+5FhC9gOZHB5RmzLKfhUoh+E1bBBxTYmve8k0bX2dg+opzCXmgjE/9vuAaIPNSAPBkHxr1TACUIwbRBBWF9FqcfKjVbFO3Ki9JqKCbKGOfpzX2gH6Vhjb39Uap1hO4imgUnNr2zJC1rm8imXaqmgh2qdqCsN6TeikJDEZRexRIJKh9JqKCefO/qtVhQQXI8JTuIpkdsBtMpo8zU+sxr2mFia8uzBSwRNicQNVHQdqgMxNDRG9VhvTb0UvAVzKPNQ+k1bhBOoSP6rOK4Ux9OtNeC0pwOY9UzNXRF5dvyR39pgfqRaHCjsp4Y2ssBat2Rqj8rD+mzopTbCjzTW5nHVQMtgFpwo1aCfxu6obrRQrCtBDiReqcxmQ+VRRCRxTsCL4lIzI8t9ngN3IbqduZlJ7S1265HRQekzopOAr5TLBKw3CpALQaSpInh7rHPujAJWAw8cs1H4KnwkeGcQ3Y6p3CVhONycVivWd7PAjVyG6nNMJTyXPukxoLgmta1oACl0YUeabuVhuD/Sl3Ci4VjD5h07ol2UP7g9Cu0fUHQJ3A5YXjcjaxPqu9kN1g+aCxPAFeqZx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'));
    win.document.close();
  
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ / Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…Ù„Ø§Ùƒ
  (function(){
    var tabs = document.getElementById('bizTabs');
    if(tabs && !tabs.__wired){
      tabs.addEventListener('click', function(e){
        var chip = e.target.closest('.chip[data-biz]');
        if(!chip) return;
        bizTab = chip.getAttribute('data-biz') || 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ù†ÙŠ';
        tabs.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('active'); });
        chip.classList.add('active');
        renderDashboard();
      }, false);
      tabs.__wired = true;
    }
  })();

  try{ win.focus(); }catch(e){}
  }catch(e){
    console.error('receipt error', e);
  }
};
</script>
